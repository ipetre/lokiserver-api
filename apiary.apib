HOST: http://lokiserver.apiary.io/loki

--- LWS-REST ---

---

# This documentation is for the public API, GA release (LWS-REST 2.39).
See also [dev (pre-release) documentation](http://docs.lokidev.apiary.io/)  and [branch (pre-release) documentation](http://docs.lokiserverbranch.apiary.io).

Documentation for the Loki Provisioning LWS-REST API.

#General

At this time, the application/hal+json content type is supported in request and response bodies.

**Note: all references to <code>lokiserver.apiary.io</code> are for example purposes only. In a Loki Provisioning deployment
these will be references to the Loki Provisioning API host.**

## URI Templates
Refer to https://tools.ietf.org/html/rfc6570 for details on URI Templates. Not that LWS-REST
uses reserved characters (i.e. ":") in some URI Template variables, thus the request templates
use the "{+id}" format - see additional detail at https://tools.ietf.org/html/rfc6570#section-3.2.3.

## Collections
Unless otherwise noted, Collection resources support standard REST request methods:

<dl>
<dt>HEAD
<dd>Retrieve resource metadata without retrieving the representation.
 Common response codes:
<ul>
<li>204 No Content: Resource exists. No body (no representation) is returned.
<li>404 Not Found: Resource does not exist.
</ul>
<dt>GET
<dd>Retrieve a representation of a resource. There are two standard forms of GET:
<ul>
<li>GET on a specific resource {id} (given the resource's URI).
<li>GET on the Collection, with query parameters. You can query for exact matches
on any of the core parameters, as well as any extension parameters supported by the
network elements configured in the system. Note that if appropriate, the Collection
may include a search Controller (described in the individual sections below) to support complex searches.
</ul>
Common response codes:
<ul>
<li>200 OK: Resource exists; response body contains representation.
<li>204 No Content: Resource exists; there is no body (no representation) to be returned.
<li>404 Not Found: Resource does not exist.
</ul>
<dt>POST
<dd>Create a new resource in the Collection. Also used in special cases to invoke controller resources. Common response codes:
<ul>
<li>200 OK: Pre-validation completed successfully. The optional response body includes any pre-validation results.
<li>201 Created: Resource created. URI of the created Resource is returned in the Location headder and the "url" element in the response body.
<li>204 No Content: Pre-validation completed with no action. This response is sent when a POST is called with "mode=prevalidate-only) on a resource that does not have a pre-validation routine.
<li>400 Bad Request: Request is not valid (e.g. missing required paramterer, invalid values, etc).
<li>404 Not Found: A required resource was not found (e.g. BroadWorks Group does not exist when creating a VoIP User).
<li>409 Conflict: Pre-validation failed because a resource with an identical key (which may be a composite key combining several parameters) already exists. Response body will include a link to the URI of the existing resource.
<li>422 Unprocessable Entity: Pre-validation failed due to a failed semantic test. The response body includes details on the failure(s).
<li>Some POST response codes are only sentfor certain values of the "mode" URL parameter, as noted below:
<ul>
<li>prevalidate-only: 200, 204, 400, 409, 422
<li>prevalidate-and-create: 201, 400, 409, 422
<li>create-only: 201, 400
</ul>
</ul>
<dt>PUT
<dd>Update an existing Resource in the Collection. Any key fields (those which comprise the key which uniquely identifies a resource)
are immutable (may not be changed). See the documentation for each resource for the list of keys. Common response codes:
<ul>
<li>200 OK: Resource successfully updated.
<li>400 Bad Reqkuest: Request is not valid (e.g. invalid values, etc).
<li>403 Forbidden: Update is not allowed (e.g. attempt to update a read-only field).
<li>404 Not Found: resource does not exist
</ul>
<dt>DELETE
<dd>Delete a resource. Common response codes:
<ul>
<li>204 No Content: Resource successfully deleted
<li>404 Not Found: Resource does not exist
</ul>
<dt>OPTIONS
<dd>Fetch resource metadata, including the list of allowed methods. Common response codes:
<ul>
<li>[future] 200 OK: Resource exists. Accept header lists allowed request methods. Response body may provide additional information.
<li>204 No Content: Resource exists. Accept header lists allowed request methods.
<li>404 Not Found: Resource does not exist.
</dl>
---

--
Number Translations
##Collection

Supported network elements:

* Sonus PSX

Loki must have at least one Network Element configured with support for Number Translations (e.g. Sonus PSX).

Loki must be configured to select the appropriate Network Element for new Number Translations
(by default, the first configured Network Element with Number Translations support will be used).

See the Loki documentation appropriate to the configured Network Element for mappings to 3rd-party API fields and
references to 3rd-party documentation.

Keys:

* sourceDn

Extension Keys:

* attributes
* callProcessingElement1Id
* callProcessingElement2Id
* callProcessingElement3Id
* callProcessingElement4Id
* callProcessingElementType

[pending: per-parameter descriptions - pending an apiary.io upgrade]

[pending: per-parameter schema/validation information - pending an apiary.io upgrade]

Refer to the **Sonus Insight API Programmer Guide** for descriptions, data types, defaults, and allowed values for
request and response properties under <code>extensions.sonusPsx</code>. Note:

* If the Sonus documentation indicates a data type of integer, short, or long, the value will be numeric in the LWS-REST JSON responses.
* If the Sonus documentation indicates a data type of string, the value will be a string (or null) in the LWS-REST JSON responses.
--

Create a new Number Translation.
POST /number-translations
> Content-Type: application/json
{
    "sourceDn" : "+1-8665554321",
    "translatedDn" : "+1-5553043000",
    "extensions" : {
        "sonusPsx" : {
            "attributes" : 0,
            "callProcessingElement1Id" : "978",
            "callProcessingElement2Id" : null,
            "callProcessingElement3Id" : null,
            "callProcessingElement4Id" : null,
            "callProcessingElementType" : 5,
            "servicesProvisioned" : 0,
            "phoneType" : 1,
            "suspendedFlag" : 0,
            "directTranslationFlag" : 0,
            "translationLabelId" : null,
            "translatedCarrierId" : null,
            "translatedCalltype" : 0,
            "translatedNpi" : 0,
            "translatedNoa" : 13,
            "useTranslationProfile" : 0,
            "translationProfileId" : null
        }
    }
}
< 201
< Location: http://lokiserver.apiary.io/loki/number-translations/3-1-8665554321-0-978----5
< Transaction-Id: 1380080943120
+++++
< 409
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/number-translations"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:number-translations" : {
            "_links" : {
                "self" : {
                    "href" : "http://lokiserver.apiary.io/loki/number-translations/3-1-8665554321-0-978----5"
                }
            },
            "id" : "3-1-8665554321-0-978----5",
            "sourceDn" : "+1-8665554321",
            "translatedDn" : "+1-5553043210",
            "extensions" : {
                "sonusPsx" : {
                    "attributes" : 0,
                    "callProcessingElement1Id" : "978",
                    "callProcessingElement2Id" : null,
                    "callProcessingElement3Id" : null,
                    "callProcessingElement4Id" : null,
                    "callProcessingElementType" : 5,
                    "servicesProvisioned" : 1,
                    "phoneType" : 0,
                    "suspendedFlag" : 0,
                    "directTranslationFlag" : 0,
                    "translationLabelId" : null,
                    "translatedCarrierId" : null,
                    "translatedCalltype" : 0,
                    "translatedNpi" : 0,
                    "translatedNoa" : 12,
                    "useTranslationProfile" : 0,
                    "translationProfileId" : null
                }
            }
        }
    }
}
+++++
< 500
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "**tbd",
    "summary" : "Internal Error",
    "detail" : "[detail here]"
}


Query number translations. Responses will include (at a minimum) they fields comprising the unique key for the resource.

[future: pagination of results via offset and max; field parameter to specify included/excluded fields]

[future: enhance to include all parameters, not just the key and the full uri? means larger response body,
but also means the client doesn't have to follow with a get /loki/number-translations/{+id} if they want the full resource
representation.]

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Type</th>
    <th>Mode</th>
    </thead>
    <tbody>
        <tr>
            <td>sourceDn</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>core</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>attributes</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>callProcessingElement1Id</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>callProcessingElement2Id</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>callProcessingElement3Id</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>callProcessingElement4Id</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>callProcessingElementType</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>extension</td>
            <td>Equal To</td>
        </tr>
    </tbody>
</table>
GET /number-translations{?sourceDn,attributes,callProcessingElement1Id,callProcessingElement2Id,callProcessingElement3Id,callProcessingElement4Id,callProcessingElementType}
< 200
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/number-translations?sourceDn=%2B1-8665554321&attributes=0&callProcessingElement1Id=978&callProcessingElement2Id=&callProcessingElement3Id=&callProcessingElement4Id=&callProcessingElementType=5"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:number-translations" : [
            {
                "_links" : {
                    "self" : {
                        "href" : "http://lokiserver.apiary.io/loki/number-translations/3-1-8665554321-0-978----5"
                    }
                },
                "id" : "3-1-8665554321-0-978----5",
                "sourceDn" : "+1-8665554321",
                "translatedDn" : "+1-5553043000",
                "extensions" : {
                    "sonusPsx" : {
                        "attributes" : 0,
                        "callProcessingElement1Id" : "978",
                        "callProcessingElement2Id" : null,
                        "callProcessingElement3Id" : null,
                        "callProcessingElement4Id" : null,
                        "callProcessingElementType" : 5,
                        "servicesProvisioned" : 0,
                        "phoneType" : 1,
                        "suspendedFlag" : 0,
                        "directTranslationFlag" : 0,
                        "translationLabelId" : null,
                        "translatedCarrierId" : null,
                        "translatedCalltype" : 0,
                        "translatedNpi" : 0,
                        "translatedNoa" : 13,
                        "useTranslationProfile" : 0,
                        "translationProfileId" : null
                    }
                }
            }
        ]
    }
}
+++++
< 404
< Transaction-Id: 1380080943120
{
    "errorCode": "ERR_REC_NOT_FOUND",
    "summary": "Failed to 'Retrieve' entity.",
    "detail": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" [^] xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" [^] xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n [^] <soapenv:Body>\n <soapenv:Fault>\n <faultcode>soapenv:Server.generalException</faultcode>\n <faultstring></faultstring>\n <detail>\n <ns1:fault href=\"#id0\" xmlns:ns1=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/intf\"/>\n [^] <ns2:exceptionName xmlns:ns2=\"http://xml.apache.org/axis/\">com.sonus.ems.api.psx.r07_03_06.model.ProvApiException</ns2:exceptionName>\n [^] </detail>\n </soapenv:Fault>\n <multiRef id=\"id0\" soapenc:root=\"0\" soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xsi:type=\"ns3:ProvApiException\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xmlns:ns3=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/model\">\n [^] <errorCode xsi:type=\"xsd:string\">ERR_REC_NOT_FOUND</errorCode>\n <message xsi:type=\"xsd:string\">Failed to 'Retrieve' entity.</message>\n <rootCause xsi:type=\"xsd:string\">(ERR_REC_NOT_FOUND) [resource] not found for the given criteria. (rc=17)</rootCause>\n </multiRef>\n </soapenv:Body>\n</soapenv:Envelope>"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Internal Error",
    "detail" : "Request validation failed: params.sourceDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}


Update a number translation. All fields are optional.
PUT /number-translations/{+id}
> Content-Type: application/json
{
    "translatedDn" : "+1-5553043000",
    "extensions" : {
        "sonusPsx" : {
            "servicesProvisioned" : 0,
            "phoneType" : 1,
            "suspendedFlag" : 0,
            "directTranslationFlag" : 0,
            "translationLabelId" : null,
            "translatedCarrierId" : null,
            "translatedCalltype" : 0,
            "translatedNpi" : 0,
            "translatedNoa" : 13,
            "useTranslationProfile" : 0,
            "translationProfileId" : null
        }
    }
}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


Delete a number translation.
DELETE /number-translations/{+id}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


--
Subscribers
##Collection

Supported network elements:

* Sonus PSX

Keys:

* subscriberDn

Extension Keys:

* owningCarrierId

Refer to the **Sonus Insight API Programmer Guide** for descriptions, data types, defaults, and allowed values for
request and response properties under <code>extensions.sonusPsx</code>. Note:

* If the Sonus documentation indicates a data type of integer, short, or long, the value will be numeric in the LWS-REST JSON responses.
* If the Sonus documentation indicates a data type of string, the value will be a string (or null) in the LWS-REST JSON responses.
--


Create a new Subscriber.
POST /subscribers
> Content-Type: application/json
{
    "subscriberDn" : "+1-2005553001",
    "extensions" : {
        "sonusPsx" : {
            "owningCarrierId" : "16",
            "businessGroupId" : null,
            "interLataCarrierId" : "5000",
            "intraLataCarrierId" : "5000",
            "intlCarrierId" : "5000",
            "assignedCarrierId" : null,
            "presentationFlag" : 0,
            "prfdPacketServiceProfileId" : null,
            "optionType" : 0,
            "testSubscriber" : 0,
            "billingPlanId" : "EXAMPLE_PLAN",
            "localCarrierId" : "5000",
            "authcodeScriptId" : "EXAMPLE_SCRIPT",
            "elementAttributes" : 0,
            "classOfServiceId" : "EXAMPLE_COS",
            "pseudoCarrierId" : null,
            "infoDigitId" : null,
            "scpBusinessServiceGroup" : 0,
            "authcodeGroupId" : null,
            "pinDigits" : null,
            "svcList1" : 0,
            "svcList2" : 0,
            "exceptionProfileId" : "EXAMPLE_PROFILE",
            "isDestination" : 1,
            "defaultCpc" : null,
            "homeMobileNetwork" : 0,
            "origEntityRoutingProfileId" : "EXAMPLE_RTGPROFILE",
            "callingArea" : "555_EXAMPLE",
            "businessUnitId" : null,
            "deviceProfileId" : null,
            "memberStatus" : -1
        }
    }
}
< 201
< Location: http://lokiserver.apiary.io/loki/subscribers/1-2005553001-1-16
< Transaction-Id: 1380080943120
+++++
< 409
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/subscribers"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:subscribers" : {
            "_links" : {
                "self" : {
                    "href" : "http://lokiserver.apiary.io/loki/subscribers/1-2005553001-1-16"
                }
            },
            "id" : "1-2005553001-1-16",
            "subscriberDn" : "+1-2005553001",
            "extensions" : {
                "sonusPsx" : {
                    "owningCarrierId" : "16",
                    "businessGroupId" : null,
                    "interLataCarrierId" : "0000",
                    "intraLataCarrierId" : "0000",
                    "intlCarrierId" : "0000",
                    "assignedCarrierId" : null,
                    "presentationFlag" : 0,
                    "prfdPacketServiceProfileId" : null,
                    "optionType" : 0,
                    "testSubscriber" : 0,
                    "billingPlanId" : "EXAMPLE_ANOTHER",
                    "localCarrierId" : "0000",
                    "authcodeScriptId" : "EXAMPLE_ANOTHER",
                    "elementAttributes" : 0,
                    "classOfServiceId" : "EXAMPLE_ANOTHER",
                    "pseudoCarrierId" : null,
                    "infoDigitId" : null,
                    "scpBusinessServiceGroup" : 0,
                    "authcodeGroupId" : null,
                    "pinDigits" : null,
                    "svcList1" : 0,
                    "svcList2" : 0,
                    "exceptionProfileId" : "EXAMPLE_ANOTHER",
                    "isDestination" : 1,
                    "defaultCpc" : null,
                    "homeMobileNetwork" : 0,
                    "origEntityRoutingProfileId" : "EXAMPLE_ANOTHER",
                    "callingArea" : "555_ANOTHER",
                    "businessUnitId" : null,
                    "deviceProfileId" : null,
                    "memberStatus" : -1
                }
            }
        }
    }
}
+++++
< 500
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "**tbd",
    "summary" : "**tbd Internal Error",
    "detail" : "[detail here]"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.subscriberDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}

Query Subscribers. Responses will include (at a minimum) they fields comprising the unique key for the resource.

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Mode</th>
    </thead>
    <tbody>
        <tr>
            <td>subscriberDn</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>Equal To</td>
        </tr>
        <tr>
            <td>owningCarrierId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>Equal To</td>
        </tr>
    </tbody>
</table>
GET /subscribers{?subscriberDn,owningCarrierId}
< 200
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/subscribers?subscriberDn=%2B1-2005553001&owningCarrierId=16"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:subscribers" : [
            {
                "_links" : {
                    "self" : {
                        "href" : "http://lokiserver.apiary.io/loki/subscribers/1-2005553001-1-16"
                    }
                },
                "id" : "1-2005553001-1-16",
                "subscriberDn" : "+1-2005553001",
                "extensions" : {
                    "sonusPsx" : {
                        "owningCarrierId" : "16",
                        "businessGroupId" : null,
                        "interLataCarrierId" : "5000",
                        "intraLataCarrierId" : "5000",
                        "intlCarrierId" : "5000",
                        "assignedCarrierId" : null,
                        "presentationFlag" : 0,
                        "prfdPacketServiceProfileId" : null,
                        "optionType" : 0,
                        "testSubscriber" : 0,
                        "billingPlanId" : "EXAMPLE_PLAN",
                        "localCarrierId" : "5000",
                        "authcodeScriptId" : "EXAMPLE_SCRIPT",
                        "elementAttributes" : 0,
                        "classOfServiceId" : "EXAMPLE_COS",
                        "pseudoCarrierId" : null,
                        "infoDigitId" : null,
                        "scpBusinessServiceGroup" : 0,
                        "authcodeGroupId" : null,
                        "pinDigits" : null,
                        "svcList1" : 0,
                        "svcList2" : 0,
                        "exceptionProfileId" : "EXAMPLE_PROFILE",
                        "isDestination" : 1,
                        "defaultCpc" : null,
                        "homeMobileNetwork" : 0,
                        "origEntityRoutingProfileId" : "EXAMPLE_RTGPROFILE",
                        "callingArea" : "555_EXAMPLE",
                        "businessUnitId" : null,
                        "deviceProfileId" : null,
                        "memberStatus" : -1
                    }
                }
            }
        ]
    }
}
+++++
< 404
< Transaction-Id: 1380080943120
{
    "errorCode": "ERR_REC_NOT_FOUND",
    "summary": "Failed to 'Retrieve' entity.",
    "detail": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" [^] xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" [^] xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n [^] <soapenv:Body>\n <soapenv:Fault>\n <faultcode>soapenv:Server.generalException</faultcode>\n <faultstring></faultstring>\n <detail>\n <ns1:fault href=\"#id0\" xmlns:ns1=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/intf\"/>\n [^] <ns2:exceptionName xmlns:ns2=\"http://xml.apache.org/axis/\">com.sonus.ems.api.psx.r07_03_06.model.ProvApiException</ns2:exceptionName>\n [^] </detail>\n </soapenv:Fault>\n <multiRef id=\"id0\" soapenc:root=\"0\" soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xsi:type=\"ns3:ProvApiException\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xmlns:ns3=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/model\">\n [^] <errorCode xsi:type=\"xsd:string\">ERR_REC_NOT_FOUND</errorCode>\n <message xsi:type=\"xsd:string\">Failed to 'Retrieve' entity.</message>\n <rootCause xsi:type=\"xsd:string\">(ERR_REC_NOT_FOUND) [resource] not found for the given criteria. (rc=17)</rootCause>\n </multiRef>\n </soapenv:Body>\n</soapenv:Envelope>"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.subscriberDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}


Update a subscriber. All fields are optional.
PUT /subscribers/{+id}
> Content-Type: application/json
{
    "extensions" : {
        "sonusPsx" : {
            "businessGroupId" : null,
            "interLataCarrierId" : "5000",
            "intraLataCarrierId" : "5000",
            "intlCarrierId" : "5000",
            "assignedCarrierId" : null,
            "presentationFlag" : 0,
            "prfdPacketServiceProfileId" : null,
            "optionType" : 0,
            "testSubscriber" : 0,
            "billingPlanId" : "EXAMPLE_PLAN",
            "localCarrierId" : "5000",
            "authcodeScriptId" : "EXAMPLE_SCRIPT",
            "elementAttributes" : 0,
            "classOfServiceId" : "EXAMPLE_COS",
            "pseudoCarrierId" : null,
            "infoDigitId" : null,
            "scpBusinessServiceGroup" : 0,
            "authcodeGroupId" : null,
            "pinDigits" : null,
            "svcList1" : 0,
            "svcList2" : 0,
            "exceptionProfileId" : "EXAMPLE_PROFILE",
            "isDestination" : 1,
            "defaultCpc" : null,
            "homeMobileNetwork" : 0,
            "origEntityRoutingProfileId" : "EXAMPLE_RTGPROFILE",
            "callingArea" : "555_EXAMPLE",
            "businessUnitId" : null,
            "deviceProfileId" : null,
            "memberStatus" : -1
        }
    }
}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


Delete a subscriber.
DELETE /subscribers/{+id}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


--
Destinations
##Collection

Supported network elements:

* Sonus PSX

Keys:

* destinationDn

Extension Keys:

* (none)

Refer to the **Sonus Insight API Programmer Guide** for descriptions, data types, defaults, and allowed values for
request and response properties under <code>extensions.sonusPsx</code>. Note:

* If the Sonus documentation indicates a data type of integer, short, or long, the value will be numeric in the LWS-REST JSON responses.
* If the Sonus documentation indicates a data type of string, the value will be a string (or null) in the LWS-REST JSON responses.
--

Create a new Destination.
POST /destinations
> Content-Type: application/json
{
    "destinationDn" : "+1-2005553001",
    "extensions" : {
        "sonusPsx" : {
            "destSvcScriptId" : null,
            "customScriptId" : null,
            "elementAttributes" : 0,
            "prfdPacketServiceProfileId" : null,
            "routingLabelId" : "EXAMPLE_RTNG_LBL",
            "isSubscriber" : 1,
            "portedType" : 0,
            "lnpTransitionFlag" : 0,
            "homeGateway" : "EXAMPLE_GW",
            "exceptionProfileId" : null,
            "businessGroupId" : null,
            "businessUnitId" : null
        }
    }
}
< 201
< Location: http://lokiserver.apiary.io/loki/destinations/1-2005553001-1
< Transaction-Id: 1380080943120
+++++
< 409
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/destinations"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:destinations" : {
            "_links" : {
                "self" : {
                    "href" : "http://lokiserver.apiary.io/loki/destinations/1-2005553001-1"
                }
            },
            "id" : "1-2005553001-1",
            "destinationDn" : "+1-2005553001",
            "extensions" : {
                "sonusPsx" : {
                    "destSvcScriptId" : null,
                    "customScriptId" : null,
                    "elementAttributes" : 0,
                    "prfdPacketServiceProfileId" : null,
                    "routingLabelId" : "EXAMPLE_RTNG_LBL",
                    "isSubscriber" : 1,
                    "portedType" : 0,
                    "lnpTransitionFlag" : 0,
                    "homeGateway" : "EXAMPLE_GW",
                    "exceptionProfileId" : null,
                    "businessGroupId" : null,
                    "businessUnitId" : null
                }
            }
        }
    }
}
+++++
< 500
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "**tbd",
    "summary" : "**tbd Internal Error",
    "detail" : "[detail here]"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.destinationDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}

Query Destinations. Responses will include (at a minimum) they fields comprising the unique key for the resource.

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Mode</th>
    </thead>
    <tbody>
        <tr>
            <td>destinationDn</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>Equal To</td>
        </tr>
    </tbody>
</table>
GET /destinations{?destinationDn}
< 200
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/destinations?destinationDn=%2B1-2005553001"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:destinations" : [
            {
                "_links" : {
                    "self" : {
                        "href" : "http://lokiserver.apiary.io/loki/destinations/1-2005553001-1"
                    }
                },
                "id" : "1-2005553001-1",
                "destinationDn" : "+1-2005553001",
                "extensions" : {
                    "sonusPsx" : {
                        "destSvcScriptId" : null,
                        "customScriptId" : null,
                        "elementAttributes" : 0,
                        "prfdPacketServiceProfileId" : null,
                        "routingLabelId" : "ANOTHER_RTNG_LBL",
                        "isSubscriber" : 0,
                        "portedType" : 0,
                        "lnpTransitionFlag" : 0,
                        "homeGateway" : "ANOTHER_GW",
                        "exceptionProfileId" : null,
                        "businessGroupId" : null,
                        "businessUnitId" : null
                    }
                }
            }
        ]
    }
}
+++++
< 404
< Transaction-Id: 1380080943120
{
    "errorCode": "ERR_REC_NOT_FOUND",
    "summary": "Failed to 'Retrieve' entity.",
    "detail": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" [^] xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" [^] xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n [^] <soapenv:Body>\n <soapenv:Fault>\n <faultcode>soapenv:Server.generalException</faultcode>\n <faultstring></faultstring>\n <detail>\n <ns1:fault href=\"#id0\" xmlns:ns1=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/intf\"/>\n [^] <ns2:exceptionName xmlns:ns2=\"http://xml.apache.org/axis/\">com.sonus.ems.api.psx.r07_03_06.model.ProvApiException</ns2:exceptionName>\n [^] </detail>\n </soapenv:Fault>\n <multiRef id=\"id0\" soapenc:root=\"0\" soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xsi:type=\"ns3:ProvApiException\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xmlns:ns3=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/model\">\n [^] <errorCode xsi:type=\"xsd:string\">ERR_REC_NOT_FOUND</errorCode>\n <message xsi:type=\"xsd:string\">Failed to 'Retrieve' entity.</message>\n <rootCause xsi:type=\"xsd:string\">(ERR_REC_NOT_FOUND) [resource] not found for the given criteria. (rc=17)</rootCause>\n </multiRef>\n </soapenv:Body>\n</soapenv:Envelope>"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.destinationDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}


Update a destination. All fields are optional.
PUT /destinations/{+id}
> Content-Type: application/json
{
    "extensions" : {
        "sonusPsx" : {
            "destSvcScriptId" : null,
            "customScriptId" : null,
            "elementAttributes" : 0,
            "prfdPacketServiceProfileId" : null,
            "routingLabelId" : "EXAMPLE_RTNG_LBL",
            "isSubscriber" : 1,
            "portedType" : 0,
            "lnpTransitionFlag" : 0,
            "homeGateway" : "EXAMPLE_GW",
            "exceptionProfileId" : null,
            "businessGroupId" : null,
            "businessUnitId" : null
        }
    }
}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


Delete a destination.
DELETE /destinations/{+id}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


--
Routes
##Collection

Supported network elements:

* Sonus PSX

Keys:

* destinationDn

Extension Keys:

* callProcessingElement1Id
* callProcessingElement2Id
* callProcessingElement3Id
* callProcessingElement4Id
* callProcessingElementType
* routingType
* partitionId
* calltype
* transmissionMedium
* userCallType
* digitType
* timeRangeProfileId
* callParamFilterProfileId
* domainName

Refer to the **Sonus Insight API Programmer Guide** for descriptions, data types, defaults, and allowed values for
request and response properties under <code>extensions.sonusPsx</code>. Note:

* If the Sonus documentation indicates a data type of integer, short, or long, the value will be numeric in the LWS-REST JSON responses.
* If the Sonus documentation indicates a data type of string, the value will be a string (or null) in the LWS-REST JSON responses.
--

Create a new Route.
POST /routes
> Content-Type: application/json
{
    "destinationDn" : "+1-2005553001",
    "extensions" : {
        "sonusPsx" : {
	        "callProcessingElement1Id" : null,
	        "callProcessingElement2Id" : null,
	        "callProcessingElement3Id" : null,
	        "callProcessingElement4Id" : null,
	        "callProcessingElementType" : 0,
	        "routingType" : 3,
	        "partitionId" : "EXAMPLE_PARTITION",
	        "calltype" : 0,
	        "transmissionMedium" : 0,
	        "userCallType" : 0,
	        "digitType" : 2147483647,
	        "timeRangeProfileId" : "ALL",
	        "callParamFilterProfileId" : null,
	        "domainName" : null,
	        "routingLabelId" : "EXAMPLE_RTNG_LBL"
        }
    }
}
< 201
< Location: http://lokiserver.apiary.io/loki/routes/1-----0-3-2005553001-1-EXAMPLE_PARTITION-0-0-0-2147483647-ALL--
< Transaction-Id: 1380080943120
+++++
< 409
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/routes"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "_embedded" : {
        "ls:routes" : {
            "_links" : {
                "self" : {
                    "href" : "http://lokiserver.apiary.io/loki/routes/1-----0-3-2005553001-1-EXAMPLE_PARTITION-0-0-0-2147483647-ALL--"
                }
            },
            "id" : "1-----0-3-2005553001-1-EXAMPLE_PARTITION-0-0-0-2147483647-ALL--",
            "destinationDn" : "+1-2005553001",
            "extensions" : {
                "sonusPsx" : {
	                "callProcessingElement1Id" : null,
	                "callProcessingElement2Id" : null,
	                "callProcessingElement3Id" : null,
	                "callProcessingElement4Id" : null,
	                "callProcessingElementType" : 0,
	                "routingType" : 3,
	                "partitionId" : "EXAMPLE_PARTITION",
	                "calltype" : 0,
	                "transmissionMedium" : 0,
	                "userCallType" : 0,
	                "digitType" : 2147483647,
	                "timeRangeProfileId" : "ALL",
	                "callParamFilterProfileId" : null,
	                "domainName" : null,
	                "routingLabelId" : "ANOTHER_RTNG_LBL"
                }
            }
        }
    }
}
+++++
< 500
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "**tbd",
    "summary" : "**tbd Internal Error",
    "detail" : "[detail here]"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.destinationDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}

Query Routes. Responses will include (at a minimum) they fields comprising the unique key for the resource.

##URI Query Parameters

This request supports two modes. In both cases:

* Each parameter is expected to be complete (the match is an "equals" match, with
no support for wildcards or partial values).
* A "null" value can be searched for by explicitly including the parameter with no value,
e.g. "...&callProcessingElement1Id=".
* If no match is found, the response will be 404 Not Found
* When one or more matches or found, they will be included in the embedded array _embedded."ls:routes"[].

To retrieve a single route resource given all elements of the key, include **all** of (and only) the following
parameters in the request (even if some have null values):

* destinationDn
* callProcessingElement1Id
* callProcessingElement2Id
* callProcessingElement3Id
* callProcessingElement4Id
* callProcessingElementType
* routingType
* partitionId
* calltype
* transmissionMedium
* userCallType
* digitType
* timeRangeProfileId
* callParamFilterProfileId
* domainName

To retrieve all matching route resources for various search criteria, include one or more of the following
parameters in the request:

* destinationDn
* partitionId
* callProcessingElement1Id
* callProcessingElement2Id
* callProcessingElement3Id
* callProcessingElement4Id
* routingLabelId
* callParamFilterProfileId
* domainName
GET /routes{?...}
< 200
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
        "_links" : {
            "self" : {
                "href" : "http://lokiserver.apiary.io/loki/routes?destinationDn=%2B1-2005553001&callProcessingElement1Id=&callProcessingElement2Id=&callProcessingElement3Id=&callProcessingElement4Id=&callProcessingElementType=0&routingType=3&partitionId=EXAMPLE_PARTITION&calltype=0&transmissionMedium=0&userCallType=0&digitType=2147483647&timeRangeProfileId=ALL&callParamFilterProfileId=&domainName="
            }
        },
        "curies" : [
            {
                "name" : "ls",
                "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
                "templated" : true
            }
        ],
        "_embedded" : {
            "ls:routes" : [
                {
                    "_links" : {
                        "self" : {
                            "href" : "http://lokiserver.apiary.io/loki/routes/1-----0-3-2005553001-1-EXAMPLE_PARTITION-0-0-0-2147483647-ALL--"
                        }
                    },
                    "id" : "1-----0-3-2005553001-1-EXAMPLE_PARTITION-0-0-0-2147483647-ALL--",
                    "destinationDn" : "+1-2005553001",
                    "extensions" : {
                        "sonusPsx" : {
    	                    "callProcessingElement1Id" : null,
        	                "callProcessingElement2Id" : null,
    	                    "callProcessingElement3Id" : null,
    	                    "callProcessingElement4Id" : null,
    	                    "callProcessingElementType" : 0,
    	                    "routingType" : 3,
    	                    "partitionId" : "EXAMPLE_PARTITION",
        	                "calltype" : 0,
    	                    "transmissionMedium" : 0,
    	                    "userCallType" : 0,
    	                    "digitType" : 2147483647,
    	                    "timeRangeProfileId" : "ALL",
    	                    "callParamFilterProfileId" : null,
        	                "domainName" : null,
    	                    "routingLabelId" : "EXAMPLE_RTNG_LBL"
                        }
                    }
                },
                {
                    "_links" : {
                        "self" : {
                            "href" : "http://lokiserver.apiary.io/loki/routes/1-4----0-3-2005553001-1-ANOTHER_PARTITION-0-0-0-2147483647-ALL--"
                        }
                    },
                    "id" : "1-4----0-3-2005553001-1-ANOTHER_PARTITION-0-0-0-2147483647-ALL--",
                    "destinationDn" : "+1-2005553001",
                    "extensions" : {
                        "sonusPsx" : {
    	                    "callProcessingElement1Id" : 4,
        	                "callProcessingElement2Id" : null,
    	                    "callProcessingElement3Id" : null,
    	                    "callProcessingElement4Id" : null,
    	                    "callProcessingElementType" : 0,
    	                    "routingType" : 3,
    	                    "partitionId" : "ANOTHER_PARTITION",
        	                "calltype" : 0,
    	                    "transmissionMedium" : 0,
    	                    "userCallType" : 0,
    	                    "digitType" : 2147483647,
    	                    "timeRangeProfileId" : "ALL",
    	                    "callParamFilterProfileId" : null,
        	                "domainName" : null,
    	                    "routingLabelId" : "ANOTHER_RTNG_LBL"
                        }
                    }
                }
            ]
        }
}
+++++
< 404
< Transaction-Id: 1380080943120
{
    "errorCode": "ERR_REC_NOT_FOUND",
    "summary": "Failed to 'Retrieve' entity.",
    "detail": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" [^] xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" [^] xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n [^] <soapenv:Body>\n <soapenv:Fault>\n <faultcode>soapenv:Server.generalException</faultcode>\n <faultstring></faultstring>\n <detail>\n <ns1:fault href=\"#id0\" xmlns:ns1=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/intf\"/>\n [^] <ns2:exceptionName xmlns:ns2=\"http://xml.apache.org/axis/\">com.sonus.ems.api.psx.r07_03_06.model.ProvApiException</ns2:exceptionName>\n [^] </detail>\n </soapenv:Fault>\n <multiRef id=\"id0\" soapenc:root=\"0\" soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xsi:type=\"ns3:ProvApiException\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" [^] xmlns:ns3=\"http://www.sonusnet.com/ems/emsapi/psx/r07_03_06/model\">\n [^] <errorCode xsi:type=\"xsd:string\">ERR_REC_NOT_FOUND</errorCode>\n <message xsi:type=\"xsd:string\">Failed to 'Retrieve' entity.</message>\n <rootCause xsi:type=\"xsd:string\">(ERR_REC_NOT_FOUND) [resource] not found for the given criteria. (rc=17)</rootCause>\n </multiRef>\n </soapenv:Body>\n</soapenv:Envelope>"
}
+++++
< 404
< Transaction-Id: 1380080943120
{
    "errorCode": "ERR_REC_NOT_FOUND",
    "summary": "Internal Error",
    "detail": "Query returned no records"
}
+++++
< 400
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: params.destinationDn does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}


Update a route. All fields are optional.
PUT /routes/{+id}
> Content-Type: application/json
{
    "extensions" : {
        "sonusPsx" : {
	        "routingLabelId" : "EXAMPLE_RTNG_LBL"
        }
    }
}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


Delete a route.
DELETE /routes/{+id}
< 204
< Transaction-Id: 1380080943120
+++++
< 404
< Transaction-Id: 1380080943120


--
Sites
##Collection

Supported network elements:

* BroadWorks Application Server

Keys:

* customerId
* siteId

Extension Keys:

* (none)
--

Retrieve the Site matching a specific BroadWorks serviceProviderId and groupId.
Can be used to resolve the LWS-REST customerId/siteId of a Site when only the
BroadWorks IDs are known.

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>extensions.broadworks.serviceProviderId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Corresponds to the serviceProviderId of the service provider (or enterprise) in BroadWorks.
            </td>
        </tr>
        <tr>
            <td>extensions.broadworks.groupId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Corresponds to the groupId of the group in BroadWorks.
            </td>
        </tr>
    </tbody>
</table>
GET /sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}
< 200
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
{
    "_links": {
        "self": {
            "href": "http://localhost:8340/loki/customers/ExampleCom/sites/ExampleCom"
        }
    },
    "customerId": "ExampleCom",
    "siteId": "ExampleCom",
    "defaultDomain": "example.com",
    "userLimit": 25,
    "userCount": 2,
    "siteName": "ExampleCom",
    "callingLineIdName": "ExampleCom",
    "callingLineIdPhoneNumber": "+12025555003",
    "callingLineIdDisplayPhoneNumber": "2025555003",
    "timeZone": "US/Eastern",
    "locationDialingCode": "1",
    "contact": {
        "name": "bob jones",
        "number": "2028887777",
        "email": "bjones@jones.com"
    },
    "address": {
        "addressLine1": "415 Sixth Ave",
        "addressLine2": "Suite 102",
        "city": "North Seventh",
        "stateOrProvince": "Alabama",
        "zipOrPostalCode": "50415",
        "country": "USA"
    },
    "extensions": {
        "broadworks": {
            "serviceProviderId": "ExampleCom",
            "groupId": "ExampleCom"
        }
    },
    "curies": [
        {
            "name": "ls",
            "href": "http://localhost:8340/loki/rels/{rel}",
            "templated": true
        }
    ]
}


--
Site Phone Numbers
##Collection

Supported network elements:

* BroadWorks Application Server

Keys:

* customerId
* siteId
* phoneNumber

Extension Keys:

* (none)
--

Assigns a TN to a Site based on the specified TN management routine.

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>mode</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a (not optional)</td>
            <td>Controls execution mode as described in **ref general documentation.<br />
            Allowed values: [ "prevalidate-only", "prevalidate-and-create", "create-only" ].<br />
            <b>NOTE: at this time only "create-only" is allowed.</b>
            </td>
        </tr>
        <tr>
            <td>customerId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Loki Server customerId (server-generated) of the Customer in which the new TN is to be assigned.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Loki Server siteId (server-generated) of the Site in which the new TN is to be assigned.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>phoneNumber</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Phone Number.
            Will be assigned on Customer and Group.
            Must be E.164 formatted, e.g. +1-2005553001 (the dash is required, after the country code).</td>
        </tr>
        <tr>
            <td>tnRoutine</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Phone Number (TN) assignment routine.<br />
            Supported values and impact on other required properties:
            <table border=1>
            <thead>
                <th>tnRoutine</th>
                <th>Description</th>
            </thead>
            <tbody>
            <tr>
                <td><b>port-no-temp</b></td>
                <td>TN does not exist in the system, and will be assigned automatically at both the Customer and Site levels.</td>
            </tr>
            <tr>
                <td><b>auto</b></td>
                <td>TN may or may not already exist in the system, and will be assigned automatically only as needed.</td>
            </tr>
            </tbody>
            </table>
        </tr>
    </tbody>
</table>

POST /customers/{+customerId}/sites/{+siteId}/assignPhoneNumber{?mode}
> Content-Type: application/json
{
    "phoneNumber" : "+1-4165551212",
    "tnRoutine" : "port-no-temp"
}
< 200
< Transaction-Id: 1380080943120
< Content-Type: application/hal+json
{
    "_links": {
        "self": {
            "href": "http://lokiserver.apiary.io/loki/customers/Example%20Com/sites/Example%20Com%20-%20North/assignPhoneNumber"
        }
    },
    "curies": [
        {
            "name": "ls",
            "href": "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated": true
        }
    ],
    "_embedded": {
        "ls:customer-phone-numbers": [
            {
                "_links": {
                    "self": {
                        "href": "http://lokiserver.apiary.io/loki/customers/Example%20Com/phone-numbers/%2B-2005553001"
                    }
                },
                "customerId": "Example Com",
                "phoneNumber": "+1-2005553001",
                }
            }
        ],
        "ls:site-phone-numbers": [
            {
                "_links": {
                    "self": {
                        "href": "http://lokiserver.apiary.io/loki/customers/Example%20Com/sites/Example%20Com%20-%20North/phone-numbers/%2B-2005553001"
                    }
                },
                "customerId": "Example Com",
                "siteId": " Example Com - North",
                "phoneNumber": "+1-2005553001",
                }
            }
        ]
    }
}

Activate phone number(s) in a Site. The corresponding phone numbers in the underlying BroadWorks group will be set to "activated".

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>LWS-REST ID of the Site containing the phone numbers(s) to be activated.
            </td>
        </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>phoneNumbers</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>An array containing the phone numbers and/or phone number ranges to be activated.</td>
        </tr>
        <tr>
            <td>phoneNumbers[]</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The array entry for an individual phone number consists of a single phone number.<br />
            The array entry for a phone number range consists of an object. For ranges, the end value is required to be higher than the start value,
            and both are required to have the same country code.
            See below for additional details of this object's properties.<br />
            Note that the E.164 format accepted in the LWS-REST API consists of a leading “+”, followed by the country code, followed by a hyphen, followed by the national number (subscriber number), e.g. <code>+1-5554161212</code>.</td>
        </tr>
        <tr>
            <td>phoneNumbers[].start</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The first phone number in a range (inclusive). Required when activating a range.</td>
        </tr>
        <tr>
            <td>phoneNumbers[].end</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The last phone number in a range (inclusive). Required when activating a range.</td>
        </tr>
    </tbody>
</table>

A request may contain any combination of individual phone numbers and phone number ranges (in any order), as seen in the example.
POST /sites/{+siteId}/phone-numbers/activate
> Content-Type: application/json
{
    "phoneNumbers" : [
        "+1-5553070900",
        "+1-5553070910",
        {
            "start" : "+1-5553071000",
            "end" : "+1-5553071009"
        },
        "+1-5553070876",
        {
            "start" : "+1-5553072000",
            "end" : "+1-5553072003"
        }
    ]
}
< 204
< Transaction-Id: 1380080943120


Dectivate phone number(s) in a Site. The corresponding phone numbers in the underlying BroadWorks group will be set to "not activated".

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>LWS-REST ID of the Site containing the phone numbers(s) to be deactivated.
            </td>
        </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>phoneNumbers</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>An array containing the phone numbers and/or phone number ranges to be deactivated.</td>
        </tr>
        <tr>
            <td>phoneNumbers[]</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The array entry for an individual phone number consists of a single phone number.<br />
            The array entry for a phone number range consists of an object. For ranges, the end value is required to be higher than the start value,
            and both are required to have the same country code.
            See below for additional details of this object's properties.<br />
            Note that the E.164 format accepted in the LWS-REST API consists of a leading “+”, followed by the country code, followed by a hyphen, followed by the national number (subscriber number), e.g. <code>+1-5554161212</code>.</td>
        </tr>
        <tr>
            <td>phoneNumbers[].start</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The first phone number in a range (inclusive). Required when deactivating a range.</td>
        </tr>
        <tr>
            <td>phoneNumbers[].end</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>n/a</td>
            <td>The last phone number in a range (inclusive). Required when deactivating a range.</td>
        </tr>
    </tbody>
</table>

A request may contain any combination of individual phone numbers and phone number ranges (in any order), as seen in the example.
POST /sites/{+siteId}/phone-numbers/deactivate
> Content-Type: application/json
{
    "phoneNumbers" : [
        "+1-5553070900",
        "+1-5553070910",
        {
            "start" : "+1-5553071000",
            "end" : "+1-5553071009"
        },
        "+1-5553070876",
        {
            "start" : "+1-5553072000",
            "end" : "+1-5553072003"
        }
    ]
}
< 204
< Transaction-Id: 1380080943120


--
VoIP Users
##Collection

Supported network elements:

* BroadWorks Application Server

Keys:

* userId

Extension Keys:

* (none)
--

Create a new VoIP User.

Rollback-enabled: No

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>mode</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>prevalidate-and-create</td>
            <td>Controls execution mode as described in **ref general documentation.<br />
            Allowed values: [ "prevalidate-only", "prevalidate-and-create", "create-only" ].<br />
            <b>NOTE: at this time only "create-only" is allowed.</b>
            </td>
        </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>customerId</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>LWS-REST customerId (server-generated) of the Customer in which the new VoIP User is to be created.
            In a default configuration (where a VoIP User is composed of BroadWorks entities only),
            this property can be omitted if extensions.broadworks.serviceProviderId is populated.</td>
        </tr>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>LWS-REST siteId (server-generated) of the Site in which the new VoIP User is to be created.
            In a default configuration (where a VoIP User is composed of BroadWorks entities only),
            this property can be omitted if extensions.broadworks.groupId is populated.</td>
        </tr>
        <tr>
            <td>userId</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>Full UserID, including @domain. Will be constructed as [phoneNumber]@[Site default domain] if not provided.<br />
            Note that in BroadWorks, if the domain matches the BroadWorks system default domain, the BroadWorks
            userId will not contain an @domain portion. In the LWS-REST API, the userId will always include
            @domain.</td>
        </tr>
        <tr>
            <td>userType</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td></td>
            <td>Identifies the user type, which is one of “trunking”, “businessLine”, “centrex”, “systemDevice”, “noDevice”.<br />
            Initially only “trunking” and “businessLine” are supported, and other values will result in an 501 NOT_IMPLEMENTED error.</td>
        </tr>
        <tr>
            <td>accessDevice</td>
            <td style="text-align: center;">(varies)</td>
            <td></td>
            <td>Required when userType is “businessLine” (ignored otherwise).
                <table border=1>
                <thead>
                    <th>Property</th>
                    <th>Required?</th>
                    <th>Default</th>
                    <th>Notes</th>
                </thead>
                <tbody>
                <tr>
                    <td>name</td>
                    <td style="text-align: center; font-weight:bold">yes</td>
                    <td></td>
                    <td>When userType is “businessLine”, this must contain the name of an existing Site-level device (group-level device in BroadWorks).</td>
                </tr>
                <tr>
                    <td>type</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>Ignored.</td>
                </tr>
                <tr>
                    <td>model</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>Ignored.</td>
                </tr>
                <tr>
                    <td>macAddress</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>Ignored.</td>
                </tr>
                <tr>
                    <td>linePort</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>Ignored.</td>
                </tr>
                <tbody>
                </table>
            </td>
        </tr>
        <tr>
            <td>trunkGroup</td>
            <td style="text-align: center">no</td>
            <td></td>
            <td>Ignored when userType is not “trunking”.<br />
                Note that if this entire object is omitted, the user will be created as a trunking user with no assigned trunk group. For the underlying BroadWorks user,
                omitting this property corresponds to selecting device choice “Trunking” but leaving the Trunking settings blank or “None”, on the User > Profile > Addresses page in the CommPortal.<br />
                Note that at this time, the LWS-REST does not manage the “Alternate Trunk Identity” or “Enterprise Trunk” settings in the “Trunking” section of that page.
                <table border=1>
                <thead>
                    <th>Property</th>
                    <th>Required?</th>
                    <th>Default</th>
                    <th>Notes</th>
                </thead>
                <tbody>
                <tr>
                    <td>name</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>If present, must contain the name of an existing VoIP Trunk Group in the Site (trunk group in the BroadWorks group).<br />
                        If omitted (when userType is “trunking”), the trunking user will be created with no assigned trunk group. For the underlying BroadWorks user,
                        omitting this property corresponds to selecting device choice “Trunking” but leaving the Trunking / Trunk Group set to “None”, on the User > Profile > Addresses page in the CommPortal.</td>
                </tr>
                <tr>
                    <td>linePort</td>
                    <td style="text-align: center; font-weight:bold">no</td>
                    <td></td>
                    <td>Ignored.</td>
                </tr>
                <tbody>
                </table>
            </td>
        </tr>
        <tr>
            <td>phoneNumber</td>
            <td style="text-align: center">(varies)</td>
            <td></td>
            <td>Phone Number.<br />Will be assigned on Customer and/or Group if necessary.<br />
            Must be E.164 formatted, e.g. +1-2005553001 (the dash is required, after the country code).<br />
            A value is required for certain TN routines; see documentation for tnRoutine for details.<br />
        </tr>
        <tr>
            <td>tnRoutine</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Phone Number (TN) assignment routine.<br />
            Supported values and impact on other required properties:
            <table border=1>
            <thead>
                <th>tnRoutine</th>
            <th>phoneNumber Required?</th>
                <th>extension Required?</th>
                <th>Description</th>
            </thead>
            <tbody>
            <tr>
                <td><b>port-no-temp</b></td>
                <td style="text-align: center; font-weight:bold">yes</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>TN does not exist in the system, and will be assigned automatically at both the Customer and Site levels.</td>
            </tr>
            <tr>
                <td><b>auto</b></td>
                <td style="text-align: center; font-weight:bold">yes</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>TN may or may not already exist in the system, and will be assigned automatically only as needed.</td>
            </tr>
            <tr>
                <td></td>
                <td style="text-align: center; font-weight:bold">yes</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>(default when tnRoutine is empty or omitted)<br />
                TN must already be available for use; no assignment will be performed.</td>
            </tr>
            <tr>
                <td><b>no-number</b></td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td style="text-align: center; font-weight:bold">yes</td>
                <td>User will have no TN (extension-only user); phoneNumber must <i>not</i> be present.</td>
            </tr>
            <tbody>
            </table>
        </tr>
        <tr>
            <td>extension</td>
            <td style="text-align: center">(varies)</td>
            <td>(varies)</td>
            <td>Extension. Will be autopopulated if omitted, taking digits off the end of the phone number. The number of
            digits used is equal to the group's default extension length as configured in BroadWorks.<br />
            Set to <code>null</code> to create a VoIP User with no extension (note that some LWS-REST systems may be configured
            to disallow empty extensions).<br />
            A value is required for certain TN routines; see documentation for tnRoutine for details.<br /></td>
        </tr>
        <tr>
            <td>CLID</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>Calling Line ID Phone Number.<br />Must match phoneNumber or be otherwise available for assignment as a CLID TN.<br />
            Must be E.164 formatted, e.g. +1-2005553001 (the dash is required, after the country code).<br />
            If omitted, phoneNumber will be used.</td>
        </tr>
        <tr>
            <td>lastName</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>Last Name. If omitted, will be autopopulated with the 4th through the last digits of phoneNumber, after stripping the country code.</td>
        </tr>
        <tr>
            <td>firstName</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>First Name. If omitted, will be autopopulated with the1st 3 digits of phoneNumber, after stripping the country code.</td>
        </tr>
        <tr>
            <td>callingLineIdLastName</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>Calling Line ID Last Name. If omitted, will be autopopulated with lastName, with disallowed characters (percent, plus, backslash, double-quote, and extended ASCII characters (>= ASCII 128)) stripped as needed).</td>
        </tr>
        <tr>
            <td>callingLineIdFirstName</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>(varies)</td>
            <td>Calling Line ID First Name. If omitted, will be autopopulated with firstName, with disallowed characters (percent, plus, backslash, double-quote, and extended ASCII characters (>= ASCII 128)) stripped as needed).</td>
        </tr>
        <tr>
            <td>email</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>E-Mail address</td>
        </tr>
        <tr>
            <td>timeZone</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>Site's time zone</td>
            <td>Time Zone expressed as a Zone Name from the
            <a href="https://www.iana.org/time-zones">IANA Time Zone Database</a>, e.g. "America/New_York".<br />
            If omitted, the Site's time zone will be use=d.</td>
        </tr>
        <tr>
            <td>language</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td>Network element's default time zone</td>
            <td>Language<br />
            If omitted, the network element's default language (e.g. the BroadWorks system language) will be use=d.</td>
        </tr>
        <tr>
            <td>servicePacks</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>List of names of service packs to be assigned to the new VoIP User.<br />
            <b>update for base / add-on</b></td>
        </tr>
        <tr>
            <td style="font-style:italic">role</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td style="font-style:italic">Not Implemented (reserved for future use). This property will be ignored if present in a request.</td>
        </tr>
        <tr>
            <td>services</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
	        <td>The set of services to assign to the new VoIP User, with optional pre-configuration
	        settings for some services.<br />
	        Each service name must match a valid (assignable) user service on the network element. Each
	        service will be assigned to the user a la carte.  If there are global default settings (defined
	        in the configuration) for any assigned service, these will be applied.<br />
        	If the service supports configuration, configuration settings can be provided, and these will
        	override any globally configured defaults for that service. The services that support
        	configuration, and the supported settings for each, are detailed later in this table.<br />
	        To assign a service without doing any configuration, set the value to an empty object, e.g.
	        <code>"services" : { "Remote Office" : { } }</code>.<br />
            </td>
        </tr>
        <tr>
            <td>services.'Authentication'.*</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Configuration settings for the Authentication user service. The table below describes the supported settings.
            <i>Note: the default values can be overridden by the server configuration, and may not match the values shown below.</i>
            <table border=1>
            <thead>
                <th>Property</th>
                <th>Required?</th>
                <th>Default</th>
                <th>Notes</th>
            </thead>
            <tbody>
            <tr>
                <td>username</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>Username portion of userId</td>
                <td></td>
            </tr>
            <tr>
                <td>password</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>(see notes)</td>
                <td>If omitted, the password will be auto-generated based on the sipPassword rules configured in the server.<br />
                If present, the password will be validated against the sipPassword rules configured in the server.
                </td>
            </tr>
            <tbody>
            </table>
            </td>
        </tr>
        <tr>
            <td>services.'Charge Number'.*</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Configuration settings for the Charge Number user service. The table below describes the supported settings.
            <i>Note: the default values can be overridden by the server configuration, and may not match the values shown below.</i>
            <table border=1>
            <thead>
                <th>Property</th>
                <th>Required?</th>
                <th>Default</th>
                <th>Notes</th>
            </thead>
            <tbody>
            <tr>
                <td>phoneNumber</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td><i>(see notes)</i></td>
                <td>When omitted, the Charge Number TN will be assigned according to the following rules:
                <ol>
                <li>If the user has a phone number, this will be used.
                <li>Otherwise, if the Site has a Calling Line ID phone number, this will be used.
                <li>Otherwise, the Charge Number TN will be left empty.
                </ol>
                <br />
                Set to null to override automatic Charge Number TN allocation and force the Charge Number phone number to be empty.</td>
            </tr>
            <tr>
                <td>tnRoutine</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td><i>empty</i></td>
                <td>See notes for tnRoutine, above. <b>Note: the "no-number" routine is not allowed here.</b></td>
            </tr>
            <tr>
                <td>useChargeNumberForEnhancedTranslations</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>false</td>
                <td></td>
            </tr>
            <tr>
                <td>sendChargeNumberToNetwork</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true</td>
                <td></td>
            </tr>
            <tbody>
            </table>
            </td>
        </tr>
        <tr>
            <td>services.'Call Forwarding No Answer'.*</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Configuration settings for the Call Forwarding No Answer user service. The table below describes the supported settings.
            <i>Note: the default values can be overridden by the server configuration, and may not match the values shown below.</i>
            <table border=1>
            <thead>
                <th>Property</th>
                <th>Required?</th>
                <th>Default</th>
                <th>Notes</th>
            </thead>
            <tbody>
            <tr>
                <td>isActive</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true</td>
                <td>When true, forwardToPhoneNumber is required.</td>
            </tr>
            <tr>
                <td>forwardToPhoneNumber</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>null</td>
                <td>Set to null when an empty value is desired.</td>
            </tr>
            <tr>
                <td>numberOfRings</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>3</td>
                <td>Set to 0 for "None".<br />
                <i>Note that this value will override services.'Third-Party Voice Mail Support'.noAnswerNumberOfRings if both are present.</td>
            </tr>
            <tbody>
            </table>
            </td>
        </tr>
        <tr>
            <td>services.'Call Forwarding Not Reachable'.*</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Configuration settings for the Call Forwarding Not Reachable user service. The table below describes the supported settings.
            <i>Note: the default values can be overridden by the server configuration, and may not match the values shown below.</i>
            <table border=1>
            <thead>
                <th>Property</th>
                <th>Required?</th>
                <th>Default</th>
                <th>Notes</th>
            </thead>
            <tbody>
            <tr>
                <td>isActive</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true</td>
                <td>When true, forwardToPhoneNumber is required.</td>
            </tr>
            <tr>
                <td>forwardToPhoneNumber</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>null</td>
                <td>Set to null when an empty value is desired.</td>
            </tr>
            <tbody>
            </table>
            </td>
        </tr>
        <tr>
            <td>services.'Third-Party Voice Mail Support'.*</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Configuration settings for the Third-Party Voice Mail Support user service. The table below describes the supported settings.
            <i>Note: the default values can be overridden by the server configuration, and may not match the values shown below.</i>
            <table border=1>
            <thead>
                <th>Property</th>
                <th>Required?</th>
                <th>Default</th>
                <th>Notes</th>
            </thead>
            <tbody>
            <tr>
                <td>isActive</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true</td>
                <td></td>
            </tr>
            <tr>
                <td>busyRedirectToVoiceMail</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true    </td>
                <td></td>
            </tr>
            <tr>
                <td>noAnswerRedirectToVoiceMail</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>true</td>
                <td></td>
            </tr>
            <tr>
                <td>serverSelection</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>'Group Mail Server'</td>
                <td>Allowed values: {'Group Mail Server'|'User Specific Mail Server'}</td>
            </tr>
            <tr>
                <td>userServer</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>null</td>
                <td>Set to null when an empty value is desired.</td>
            </tr>
            <tr>
                <td>mailboxIdType</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>'User Or Group Phone Number'</td>
                <td>Allowed values: {'User Or Group Phone Number'|'URL'}</td>
            </tr>
            <tr>
                <td>other</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>tbd</td>
                <td>tbd</td>
            </tr>
            <tr>
                <td>noAnswerNumberOfRings</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>3</td>
                <td>Set to 0 for "None".<br />
            <i>Note that this value will be overridden by services.'Call Forwarding No Answer'.numberOfRings if both are present.</i>
            </td>
            </tr>
            <tr>
                <td>mailboxURL</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>null</td>
                <td>Set to null when an empty value is desired.</td>
            </tr>
            <tr>
                <td>alwaysRedirectToVoiceMail</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>false</td>
                <td></td>
            </tr>
            <tr>
                <td>outOfPrimaryZoneRedirectToVoiceMail</td>
                <td style="text-align: center; font-weight:bold">no</td>
                <td>false</td>
                <td></td>
            </tr>
            <tbody>
            </table>
            </td>
        </tr>
        <tr>
            <td>extensions</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Optional section for network-element-specific properties</td>
        </tr>
        <tr>
            <td>extensions. broadworks</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>Optional section for BroadWorks-specific properties</td>
        </tr>
        <tr>
            <td>extensions. broadworks. serviceProviderId</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>ID of the BroadWorks service provider or enterprse in which the underlying BroadWorks user is to be created.
            In a default configuration (where a VoIP User is composed of BroadWorks entities only),
            this property can be used instead of customerId (eliminating the need to know the server-generated customerId
            prior to placing this request).</td>
        </tr>
        <tr>
            <td>extensions. broadworks. groupId</td>
            <td style="text-align: center; font-weight:bold">no</td>
            <td></td>
            <td>ID of the BroadWorks group in which the underlying BroadWorks user is to be created.
            In a default configuration (where a VoIP User is composed of BroadWorks entities only),
            this property can be used instead of siteId (eliminating the need to know the server-generated siteId
            prior to placing this request).</td>
        </tr>

    </tbody>
</table>

###User Type
The the accessDevice and trunkGroup values vary depending on the type of user being added (userType). See examples (excerpts from a request body) below.
#### Business Line User Add
    ...
    "userType" : "businessLine",
    "accessDevice": {
        "name": "exampleComIad001"
    },
    ...
#### Trunking User Add
    ...
    "userType" : "trunking",
    "trunkGroup": {
        "name": "exampleTrunk"
    },
    ...
#### Trunking User Add with no assigned Trunk Group
    ...
    "userType" : "trunking",
    "trunkGroup": { },
    ...
#### Trunking User Add with no assigned Trunk Group (Alternative)
    ...
    "userType" : "trunking",
    ...

POST /users{?mode}
> Content-Type: application/json
{
    "customerId" : "a-server-generated-ID",
    "siteId" : "another-server-generated-ID",
    "userId" : "2005553001@example.com",
    "userType" : "businessLine",
    "phoneNumber" : "+1-2005553001",
    "tnRoutine" : "auto",
    "CLID" : "+1-2005553001",
    "extension" : "3001",
    "lastName" : "Smith",
    "firstName" : "John",
    "callingLineIdLastName" : "Smith",
    "callingLineIdFirstName" : "John",
    "email" : "jsmith@example.com",
    "timeZone" : "America/New_York",
    "language" : "English",
    "accessDevice": {
        "name": "exampleComIad001"
    },
    "servicePacks" : {
        "base" : "Standard",
        "add-on" : [
            "Executive"
        ]
    },
    "role" : "Executive",
    "services" : {
        "Authentication" : {
            "username" : "2005553001@sip.example.com",
            "password" : "230A4u$#%f"
        },
        "Charge Number" : {
            "phoneNumber" : "+1-2005554321",
            "tnRoutine" : "",
            "useChargeNumberForEnhancedTranslations" : false,
            "sendChargeNumberToNetwork" : true
        },
        "Third-Party Voice Mail Support" : {
            "isActive" : true,
            "busyRedirectToVoiceMail" : true,
            "noAnswerRedirectToVoiceMail" : true,
            "serverSelection" : "User Specific Mail Server",
            "userServer" : "4165557000",
            "mailboxIdType" : "URL",
            "mailboxURL" : "2005553001@sip.example.com",
            "noAnswerNumberOfRings" : 4,
            "alwaysRedirectToVoiceMail" : false,
            "outOfPrimaryZoneRedirectToVoiceMail" : false
        },
        "Call Forwarding No Answer" : {
            "isActive" : true,
            "forwardToPhoneNumber" : "+1-2005553101",
            "numberOfRings" : 4
        },
        "Call Forwarding Not Reachable" : {
            "isActive" : true,
            "forwardToPhoneNumber" : "+1-2005553101"
        },
        "Remote Office" : { }
    },
    "extensions" : {
        "broadworks" : {
            "serviceProviderId" : "Example Com",
            "groupId" : "Example Com - North"
        }
    }
}
< 201
< Location: http://loki3.apiary.io/loki/users/2005553001%40example.com
< Transaction-Id: 1380080943120
< Content-Type: application/hal+json
{
    "_links" : {
        "self" : {
            "href" : "http://lokiserver.apiary.io/loki/users/2005553001%40example.com"
        }
    },
    "curies" : [
        {
            "name" : "ls",
            "href" : "http://lokiserver.apiary.io/loki/rels/{rel}",
            "templated" : true
        }
    ],
    "customerId" : "Example Com",
    "siteId" : "Example Com - North",
    "phoneNumber" : "+1-2005553001",
    "extension" : "3001",
    "CLID" : "+1-2005553001",
    "userId" : "2005553001@example.com",
    "portalPassword" : "s8F!9ggo",
    "firstName" : "John",
    "lastName" : "Smith",
    "callingLineIdLastName" : "Smith",
    "callingLineIdFirstName" : "John",
    "timeZone" : "America/New_York",
    "language" : "English",
    "services" : {
        "Authentication" : {
            "username" : "2005553001@sip.example.com",
            "password" : "230A4u$#%f"
        },
        "Charge Number" : {
            "phoneNumber" : "+1-2005554321",
            "useChargeNumberForEnhancedTranslations" : false,
            "sendChargeNumberToNetwork" : true
        },
        "Third-Party Voice Mail Support" : {
            "isActive" : true,
            "busyRedirectToVoiceMail" : true,
            "noAnswerRedirectToVoiceMail" : true,
            "serverSelection" : "User Specific Mail Server",
            "userServer" : "4165557000",
            "mailboxIdType" : "URL",
            "mailboxURL" : "2005553001@sip.example.com",
            "noAnswerNumberOfRings" : 4,
            "alwaysRedirectToVoiceMail" : false,
            "outOfPrimaryZoneRedirectToVoiceMail" : false
        },
        "Call Forwarding No Answer" : {
            "isActive" : true,
            "forwardToPhoneNumber" : "+1-2005553101",
            "numberOfRings" : 4
        },
        "Call Forwarding Not Reachable" : {
            "isActive" : true,
            "forwardToPhoneNumber" : "+1-2005553101"
        },
        "Remote Office" : { }
    }
}
+++++
< 424
< Content-Type: application/json
{
    "errorCode" : "EXTERNAL_API_ERROR",
    "externalErrorCode" : "4250",
    "externalErrorSummary" : "[Warning 4250] 1 phone number(s) not added.  Verify that the number(s) are not already assigned.",
    "externalErrorDetail" : "[Warning 4250] 1 phone number(s) not added.  Verify that the number(s) are not already assigned."
}
+++++
< 404
< Content-Type: application/json
{
    "errorCode" : "NOT_FOUND",
    "externalErrorCode" : "4152",
    "externalErrorSummary" : "[Error 4152] Group not found: LeoNVB:LeoExample",
    "externalErrorDetail" : "[Error 4152] Group not found: LeoNVB:LeoExample"
}
+++++
< 500
< Transaction-Id: 1380080943120
< Content-Type: application/json
{
    "errorCode" : "INTERNAL_ERROR,
    "summary" : "Internal error creating voip-user",
    "detail" : "The server encountered an error creating the resource. Please contact your administrator for assistance."
}
+++++
< 400
< Content-Type: application/json
< Transaction-Id: 1380080943120
{
    "errorCode" : "FORMAT_ERROR",
    "summary" : "Input validation failure",
    "detail" : "Request validation failed: phoneNumber does not match pattern^\\+[0-9]+-[0-9]+$: was processing value \"+1-\""
}


--
VoIP Trunk Groups
##Collection

Supported network elements:

* BroadWorks Application Server

Keys:

* customerId
* siteId
* trunkGroupName

Extension Keys:

* (none)
--

Create a new VoIP TrunkGroup.

Rollback-enabled: No; the rollback is dependent on VoIP User Add rollback, which is not implemented.
If the trunk group add fails before the pilot user is created, the changes will be rolled back. Otherwise, no changes
will be rolled back.


##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>mode</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>prevalidate-and-create</td>
            <td>Controls execution mode as described in **ref general documentation.<br />
            Allowed values: [ "prevalidate-only", "prevalidate-and-create", "create-only" ].<br />
            <b>NOTE: at this time only "create-only" is allowed.</b>
            </td>
        </tr>
        <tr>
            <td>customerId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>LWS-REST customerId (server-generated) of the Customer in which the new VoIP Trunk Group is to be created.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>LWS-REST siteId (server-generated) of the Site in which the new VoIP Trunk Group is to be created.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
    <tr><td>trunkGroupName</td><td>yes</td><td></td><td>Trunk Group Name</td></tr>
    <tr><td>accessDevice</td><td>yes</td><td></td><td>Details of the Trunk Group's device. Properties:
        <table border=1>
            <thead>
            <th>Property</th>
            <th>Required?</th>
            <th>Default</th>
            <th>Description</th>
            </thead>
            <tbody>
            <tr>
                <td>deviceManagementRoutine</td>
                <td>no</td>
                <td>"existing"</td>
                <td>Allowed values: {"create", "existing"}. Use "create" to cause a new device to be created.
                    Use "existing" if the specified device already exists.</td>
            </tr>
            <tr>
                <td>level</td>
                <td>yes</td>
                <td>n/a</td>
                <td>Device level. Allowed values: {"Site"}.</td>
            </tr>
            <tr>
                <td>deviceType</td>
                <td>no</td>
                <td>n/a</td>
                <td>Device type.
                    Required when deviceManagementRoutine is "create".
                    Required to be a valid Device Type defined in the BroadWorks system (not validated).</td>
            </tr>
            <tr>
                <td>deviceName</td>
                <td>yes</td>
                <td>n/a</td>
                <td>Device name.</td>
            </tr>
            <tr>
                <td>hostname</td>
                <td>no</td>
                <td>n/a</td>
                <td>Device IP address or hostname</td>
            </tr>
        </table>
    </td></tr>
    <tr><td>pilotUser</td><td>yes</td><td></td><td>Required to contain the properties of a POST /loki/users request with the exception of the following properties: accessDevice, trunkGroup and userType which are disallowed in this request.
    </td></tr>
    <tr><td>department</td><td>no</td><td></td><td>Department name (only Site-level departments are supported, initially).</td></tr>
    <tr><td>capacityManagement</td><td>yes</td><td></td><td>Capacity Management settings</td></tr>
    <tr><td>capacityManagement. maxActiveCalls</td><td>yes</td><td></td><td>Maximum Active Calls settings</td></tr>
    <tr><td>capacityManagement. maxActiveCalls. total</td><td>yes</td><td></td><td>Maximum Active Calls / Total Calls</td></tr>
    <tr><td>capacityManagement. maxActiveCalls. incoming</td><td>no</td><td></td><td>Maximum Active Calls / Incoming Calls</td></tr>
    <tr><td>capacityManagement. maxActiveCalls. outgoing</td><td>no</td><td></td><td>Maximum Active Calls / Outgoing Calls</td></tr>
    <tr><td>capacityManagement. burstingMaxActiveCalls</td><td>yes</td><td></td><td>Bursting Maximum Active Calls settings</td></tr>
    <tr><td>capacityManagement. burstingMaxActiveCalls. enabled</td><td>yes</td><td></td><td>Bursting Capacity on/off</td></tr>
    <tr><td>capacityManagement. burstingMaxActiveCalls. total</td><td>(see notes)</td><td></td><td>Bursting Maximum Active Calls / Total Calls. Required if "capacityManagement. burstingMaxActiveCalls. enabled" is true.</td></tr>
    <tr><td>capacityManagement. burstingMaxActiveCalls. incoming</td><td>no</td><td></td><td>Bursting Maximum Active Calls / Incoming Calls</td></tr>
    <tr><td>capacityManagement. burstingMaxActiveCalls. outgoing</td><td>no</td><td></td><td>Bursting Maximum Active Calls / Outgoing Calls</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded</td><td>yes</td><td></td><td>Incoming Capacity Exceeded settings</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. action</td><td>no</td><td></td><td>Incoming Capacity Exceeded Action – one of {'Forward'|'Reroute'}</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. forwardAddress</td><td>(see notes)</td><td></td><td>Forward to Phone Number / SIP-URI.
        Must be a valid phone number or SIP URI.
        Required if "capacityManagement. incomingCapacityExceeded. action" is "Forward".
    </td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. rerouteTrunkGroup</td><td>(see notes)</td><td></td><td>Details of target VoIP Trunk Group.
        Required if "capacityManagement. incomingCapacityExceeded. action" is "Reroute".</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. rerouteTrunkGroup. siteId</td><td>(see notes)</td><td></td><td>siteId of Site containing the reroute target VoIP Trunk Group.
        Required if "capacityManagement. incomingCapacityExceeded. action" is "Reroute".</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. rerouteTrunkGroup. trunkGroupName</td><td>(see notes)</td><td></td><td>Name of the reroute target VoIP Trunk Group.
        Required if "capacityManagement. incomingCapacityExceeded. action" is "Reroute".</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. initialCalls</td><td>yes</td><td></td><td>Capacity Exceeded Initial Value</td></tr>
    <tr><td>capacityManagement. incomingCapacityExceeded. offsetCalls</td><td>yes</td><td></td><td>Capacity Exceeded Offset Value</td></tr>
    <tr><td>unreachableDestination</td><td>yes</td><td></td><td>Unreachable Destination settings</td></tr>
    <tr><td>unreachableDestination. timeout</td><td>yes</td><td></td><td>Unreachable Destination Timeout (seconds)</td></tr>
    <tr><td>unreachableDestination. action</td><td>no</td><td></td><td>Unreachable Destination Action – one of {'Forward'|'Reroute'}</td></tr>
    <tr><td>unreachableDestination. forwardAddress</td><td>(see notes)</td><td></td><td>Forward to Phone Number / SIP-URI.
        Must be a valid phone number or SIP URI.
        Required if "unreachableDestination. action" is "Forward".
    </td></tr>
    <tr><td>unreachableDestination. rerouteTrunkGroup</td><td>(see notes)</td><td></td><td>Details of target VoIP Trunk Group.
        Required if "unreachableDestination. action" is "Reroute".</td></tr>
    <tr><td>unreachableDestination. rerouteTrunkGroup. siteId</td><td>(see notes)</td><td></td><td>siteId of Site containing the reroute target VoIP Trunk Group.
        Required if "unreachableDestination. action" is "Reroute".</td></tr>
    <tr><td>unreachableDestination. rerouteTrunkGroup. trunkGroupName</td><td>(see notes)</td><td></td><td>Name of the reroute target VoIP Trunk Group.
        Required if "unreachableDestination. action" is "Reroute".</td></tr>
    <tr><td>authentication</td><td>yes</td><td></td><td>SIP authentication settings</td></tr>
    <tr><td>authentication. enabled</td><td>yes</td><td></td><td>Enable Authentication</td></tr>
    <tr><td>authentication. username</td><td>(see notes)</td><td></td><td>Authentication User Name. Required if "authentication. enabled" is true.</td></tr>
    <tr><td>authentication. password</td><td>(see notes)</td><td></td><td>Authentication password. Required if "authentication. enabled" is true.<br />
    If present, the password will be validated against the sipPassword rules configured in the server.
    </td></tr>
    <tr><td>hostedUsers</td><td>no</td><td></td><td>Not implemented – will be ignored if present in request.</td></tr>
    <tr><td>identity</td><td>yes</td><td></td><td>Identity settings</td></tr>
    <tr><td>identity. trunkGroupIdentity</td><td>yes</td><td></td><td>Trunk Group Identity settings</td></tr>
    <tr><td>identity. trunkGroupIdentity. identity</td><td>no</td><td></td><td>Trunk Group Identity, including @domain. Required to be a valid SIP URI.</td></tr>
    <tr><td>identity. trunkGroupIdentity. allowTerminationToTrunkGroupIdentity</td><td>yes</td><td></td><td>Allow calls directly to trunk group with Trunk Identity</td></tr>
    <tr><td>identity. trunkGroupIdentity. includeTrunkGroupIdentity</td><td>yes</td><td></td><td>Include Trunk Identity for Calls to Trunk Group</td></tr>
    <tr><td>identity. trunkGroupIdentity. includeTrunkGroupIdentityForNetworkCalls</td><td>yes</td><td></td><td>Include Trunk Identity for Calls from Trunk Group</td></tr>
    <tr><td>identity. otgDtgIdentity</td><td>yes</td><td></td><td>OTG/DTG Identity settings</td></tr>
    <tr><td>identity. otgDtgIdentity. identity</td><td>no</td><td></td><td>OTG/DTG Identity</td></tr>
    <tr><td>identity. otgDtgIdentity. allowTerminationToDtgIdentity</td><td>yes</td><td></td><td>Allow calls directly to trunk group with DTG Identity</td></tr>
    <tr><td>identity. otgDtgIdentity. includeDtgIdentity</td><td>yes</td><td></td><td>Include DTG Identity for Calls to Trunk Group</td></tr>
    <tr><td>identity. otgDtgIdentity. includeOtgIdentityForNetworkCalls</td><td>yes</td><td></td><td>Include OTG Identity for Calls from Trunk Group</td></tr>
    <tr><td>identity. enableNetworkAddressIdentity</td><td>yes</td><td></td><td>Enable Network Address Identity</td></tr>
    <tr><td>allowUnscreenedCalls</td><td>yes</td><td></td><td>Allow Unscreened Calls</td></tr>
    <tr><td>allowUnscreenedEmergencyCalls</td><td>yes</td><td></td><td>Allow Unscreened Emergency Calls</td></tr>
    <tr><td>pilotUserCallingLineIdentityPolicy</td><td>yes</td><td></td><td>Pilot User Calling Line Asserted Identity Usage Policy – one of {'All Originating Calls'|'Unscreened Originating Calls'|'No Calls'}</td></tr>
    <tr><td>pilotUserChargeNumberPolicy</td><td>yes</td><td></td><td>Pilot User Charge Number Usage Policy – one of {'All Originating Calls'|'Unscreened Originating Calls'|'No Calls'}</td></tr>
    <tr><td>callForwardingAlways</td><td>no</td><td></td><td>Call Forwarding Always settings</td></tr>
    <tr><td>callForwardingAlways. action</td><td>no</td><td></td><td>Call Forwarding Always Action – one of {'Forward'|'Reroute'}</td></tr>
    <tr><td>callForwardingAlways. forwardAddress</td><td>(see notes)</td><td></td><td>Forward to Phone Number / SIP-URI.
        Must be a valid phone number or SIP URI.
        Required if "callForwardingAlways. action" is "Forward".
    </td></tr>
    <tr><td>callForwardingAlways. rerouteTrunkGroup</td><td>(see notes)</td><td></td><td>Details of target VoIP Trunk Group. Required if "callForwardingAlways. action" is "Reroute".</td></tr>
    <tr><td>callForwardingAlways. rerouteTrunkGroup. siteId</td><td>(see notes)</td><td></td><td>siteId of Site containing the reroute target VoIP Trunk Group. Required if "callForwardingAlways. action" is "Reroute".</td></tr>
    <tr><td>callForwardingAlways. rerouteTrunkGroup. trunkGroupName</td><td>(see notes)</td><td></td><td>Name of the reroute target VoIP Trunk Group. Required if "callForwardingAlways. action" is "Reroute".</td></tr>
    <tr><td>peeringDomain</td><td>yes</td><td></td><td>Peering Domain settings</td></tr>
    <tr><td>peeringDomain. domainName</td><td>no</td><td></td><td>Peering Domain</td></tr>
    <tr><td>peeringDomain. routeToPeeringDomain</td><td>yes</td><td></td><td>Route To Peering Domain</td></tr>
    <tr><td>trunkGroupPrefix</td><td>yes</td><td></td><td>Trunk Group Prefix settings</td></tr>
    <tr><td>trunkGroupPrefix. enabled</td><td>yes</td><td></td><td>Enable Trunk Group Prefix.</td></tr>
    <tr><td>trunkGroupPrefix. prefix</td><td>(see notes)</td><td></td><td>Trunk Group Prefix. Required when "trunkGroupPrefix. enabled" is true.</td></tr>
    <tr><td>advancedReroute</td><td>yes</td><td></td><td>Stateful Trunk Group Rerouting settings</td></tr>
    <tr><td>advancedReroute. enabled</td><td>yes</td><td></td><td>Enable Stateful Trunk Group Rerouting</td></tr>
    <tr><td>advancedReroute. sendContinuousOptionsMessage</td><td>yes</td><td></td><td>Send Continuous Options Message</td></tr>
    <tr><td>advancedReroute. continuousOptionsSendingInterval</td><td>yes</td><td></td><td>Send Continuous Options Message Every (seconds)</td></tr>
    <tr><td>advancedReroute. failureOptionsSendingInterval</td><td>yes</td><td></td><td>Send Failure Options Message Every (seconds)</td></tr>
    <tr><td>advancedReroute. failureThresholdCounter</td><td>yes</td><td></td><td>Failure Threshold Counter</td></tr>
    <tr><td>advancedReroute. successThresholdCounter</td><td>yes</td><td></td><td>Success Threshold Counter</td></tr>
    <tr><td>advancedReroute. inviteFailureThresholdCounter</td><td>yes</td><td></td><td>Invite Failure Threshold Counter</td></tr>
    <tr><td>advancedReroute. inviteFailureThresholdWindow</td><td>yes</td><td></td><td>Invite Failure Threshold Window</td></tr>
    <tr><td>pilotUserCallingLineAssertedIdentityPolicy</td><td>yes</td><td></td><td>Pilot User Calling Line Asserted Identity Policy settings</td></tr>
    <tr><td>pilotUserCallingLineAssertedIdentityPolicy. useTrunkGroupCallingLineAssertedIdentityPolicy</td><td>yes</td><td></td><td>If true, use Trunk Group's Pilot User Calling Line Asserted Identity Policy. Otherwise, use the Customer's policy.</td></tr>
    <tr><td>pilotUserCallingLineAssertedIdentityPolicy.  callingLineAssertedIdentityPolicy</td><td>yes</td><td></td><td>Use this Trunk Group Policy – one of {'All Originating Calls'|'Unscreened Originating Calls'}</td></tr>
    </tbody>
</table>
POST /customers/{+customerId}/sites/{+siteId}/trunk-groups{?mode}
{
    "trunkGroupName": "ExampleCom Trunk 3001",
    "department": "Sales",
    "accessDevice": {
        "deviceManagementRoutine": "create",
        "level": "Site",
        "deviceType": "AudioCodes MP-102",
        "deviceName": "ExampleCom_AD3001",
        "hostname": "192.168.0.2"
    },
    "capacityManagement": {
        "maxActiveCalls": {
            "total": 10,
            "incoming": 4,
            "outgoing": 3
        },
        "burstingMaxActiveCalls": {
            "enabled": false,
            "total": 12,
            "incoming": 7,
            "outgoing": 9
        },
        "incomingCapacityExceeded": {
            "action": "Forward",
            "forwardAddress": "3015551212",
            "rerouteTrunkGroup": {
                "siteId": "ExampleCom",
                "trunkGroupName": "ExampleCom Trunk 1212"
            },
            "initialCalls": 2,
            "offsetCalls": 3
        }
    },
    "unreachableDestination": {
        "timeout": 10,
        "action": "Reroute",
        "forwardAddress": "3015551212",
        "rerouteTrunkGroup": {
            "siteId": "ExampleCom",
            "trunkGroupName": "ExampleCom Trunk 1212"
        }
    },
    "authentication": {
        "enabled": true,
        "username": "2405553001@example.com",
        "password": "230A4u$#%f"
    },
    "identity": {
        "trunkGroupIdentity": {
            "identity": "2405553001@example.com",
            "allowTerminationToTrunkGroupIdentity": false,
            "includeTrunkGroupIdentity": false,
            "includeTrunkGroupIdentityForNetworkCalls": false
        },
        "otgDtgIdentity": {
            "identity": "2405553001",
            "allowTerminationToDtgIdentity": false,
            "includeDtgIdentity": false,
            "includeOtgIdentityForNetworkCalls": false
        },
        "enableNetworkAddressIdentity": false
    },
    "allowUnscreenedCalls": true,
    "allowUnscreenedEmergencyCalls": false,
    "pilotUserCallingLineIdentityPolicy": "No Calls",
    "pilotUserChargeNumberPolicy": "No Calls",
    "callForwardingAlways": {
        "action": "Forward",
        "forwardAddress": "3015551212",
        "rerouteTrunkGroup": {
            "siteId": "ExampleCom",
            "trunkGroupName": "ExampleCom Trunk 1212"
        }
    },
    "peeringDomain": {
        "domainName": "example.com",
        "routeToPeeringDomain": false
    },
    "trunkGroupPrefix": {
        "enabled": false,
        "prefix": "1234"
    },
    "advancedReroute": {
        "enabled": false,
        "sendContinuousOptionsMessage": false,
        "continuousOptionsSendingInterval": 30,
        "failureOptionsSendingInterval": 10,
        "failureThresholdCounter": 1,
        "successThresholdCounter": 1,
        "inviteFailureThresholdCounter": 1,
        "inviteFailureThresholdWindow": 30
    },
    "pilotUserCallingLineAssertedIdentityPolicy": {
        "useTrunkGroupCallingLineAssertedIdentityPolicy": false,
        "callingLineAssertedIdentityPolicy": "Unscreened Originating Calls"
    },
    "pilotUser": {
        "userId": "2405553001@example.com",
        "phoneNumber": "+1-2405553001",
        "tnRoutine": "auto",
        "CLID": "+1-2405553001",
        "extension": "3001",
        "lastName": "Smith",
        "firstName": "John",
        "callingLineIdLastName": "Smith",
        "callingLineIdFirstName": "John",
        "email": "jsmith@example.com",
        "timeZone": "America/New_York",
        "language": "English",
        "servicePacks": {
            "base": "Standard",
            "add-on": [
                "Executive"
            ]
        },
        "role": "Executive",
        "services": {
            "Authentication": {
                "username": "2405553001@example.com",
                "password": "230A4u$#%f"
            },
            "Charge Number": {
                "phoneNumber": "+1-2405553001",
                "tnRoutine": "",
                "useChargeNumberForEnhancedTranslations": false,
                "sendChargeNumberToNetwork": true
            },
            "Third-Party Voice Mail Support": {
                "isActive": true,
                "busyRedirectToVoiceMail": true,
                "noAnswerRedirectToVoiceMail": true,
                "serverSelection": "User Specific Mail Server",
                "userServer": "3015557000",
                "noAnswerNumberOfRings": 4,
                "alwaysRedirectToVoiceMail": false,
                "outOfPrimaryZoneRedirectToVoiceMail": false
            },
            "Call Forwarding No Answer": {
                "isActive": true,
                "forwardToPhoneNumber": "+1-2405553101",
                "numberOfRings": 4
            },
            "Call Forwarding Not Reachable": {
                "isActive": true,
                "forwardToPhoneNumber": "+1-2405553101"
            }
        }
    }
}
< 201
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
< Location: http://localhost:8340/loki/customers/ExampleCom/sites/ExampleCom/trunk-groups/ExampleCom%20Trunk%203001
{
    "_links": {
        "self": {
            "href": "http://localhost:8340/loki/customers/ExampleCom/sites/ExampleCom/trunk-groups/ExampleCom%20Trunk%203001"
        }
    },
    "_embedded": {
        "ls:pilot-users": [
            {
                "_links": {
                    "self": {
                        "href": "http://localhost:8340/loki/users/2405553001%40example.com"
                    }
                },
                "phoneNumber": "+1-2405553001",
                "extension": "3001",
                "CLID": "+1-2405553001",
                "email": "jsmith@example.com",
                "userId": "2405553001@example.com",
                "portalPassword": "DkztwCAp",
                "firstName": "John",
                "lastName": "Smith",
                "callingLineIdLastName": "Smith",
                "callingLineIdFirstName": "John",
                "language": "English",
                "timeZone": "America/New_York",
                "services": {
                    "Authentication": {
                        "username": "2405553001@example.com",
                        "password": "230A4u$#%f"
                    },
                    "Charge Number": {
                        "phoneNumber": "+1-2405553001",
                        "tnRoutine": "",
                        "useChargeNumberForEnhancedTranslations": false,
                        "sendChargeNumberToNetwork": true
                    },
                    "Third-Party Voice Mail Support": {
                        "isActive": true,
                        "busyRedirectToVoiceMail": true,
                        "noAnswerRedirectToVoiceMail": true,
                        "serverSelection": "User Specific Mail Server",
                        "userServer": "3012297000",
                        "noAnswerNumberOfRings": 4,
                        "alwaysRedirectToVoiceMail": false,
                        "outOfPrimaryZoneRedirectToVoiceMail": false,
                        "mailboxIdType": "User Or Group Phone Number",
                        "mailboxURL": null
                    },
                    "Call Forwarding No Answer": {
                        "isActive": true,
                        "forwardToPhoneNumber": "+1-2405553101",
                        "numberOfRings": 4
                    },
                    "Call Forwarding Not Reachable": {
                        "isActive": true,
                        "forwardToPhoneNumber": "+1-2405553101"
                    }
                },
                "customerId": "ExampleCom",
                "siteId": "ExampleCom",
                "curies": [
                    {
                        "name": "ls",
                        "href": "http://localhost:8340/loki/rels/{rel}",
                        "templated": true
                    }
                ]
            }
        ]
    },
    "customerId": "ExampleCom",
    "siteId": "ExampleCom",
    "trunkGroupName": "ExampleCom Trunk 3001",
    "curies": [
        {
            "name": "ls",
            "href": "http://localhost:8340/loki/rels/{rel}",
            "templated": true
        }
    ]
}

--
VoIP Site Devices
##Collection

Supported network elements:

* BroadWorks Application Server

Keys:

* customerId
* siteId
* deviceId

Extension Keys:

* (none)
--

Create a new VoIP Site Device.

Rollback-enabled: No; If the VoIP Site Device add fails then there is nothing to rollback.

## URI Template Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>customerId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Loki Server customerId (server-generated) of the Customer in which the new VoIP Site Device is to be created.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
        <tr>
            <td>siteId</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>n/a</td>
            <td>Loki Server siteId (server-generated) of the Site in which the new VoIP Site Device is to be created.
            Note this can be resolved from the BroadWorks IDs via GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}.
            </td>
        </tr>
    </tbody>
</table>

##URI Query Parameters

<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>mode</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td>prevalidate-and-create</td>
            <td>Controls execution mode as described in **ref general documentation.<br />
            Allowed values: [ "prevalidate-only", "prevalidate-and-create", "create-only" ].<br />
            <b>NOTE: at this time only "create-only" is allowed.</b>
            </td>
       </tr>
    </tbody>
</table>

##Request Properties

Note: See the JSON Schema (**link TBD) for data types, format, length restrictions, etc.

<table border=1>
    <thead>
    <th>Property</th>
    <th>Required?</th>
    <th>Default</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>deviceName</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td></td>
            <td>Suggested name for the new device. In the default configuration, this will be used as the device name for the underlying BroadWorks device.</td>
        </tr>
        <tr>
            <td>type</td>
            <td style="text-align: center; font-weight:bold">yes</td>
            <td></td>
            <td>Device Type – a valid Device Type in BroadWorks.</td>
        </tr>
        <tr>
            <td>protocol</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Protocol – a valid device protocol on BroadWorks, e.g. SIP 2.0</td>
        </tr>
         <tr>
            <td>hostname</td>
            <td style="text-align: center;">varies</td>
            <td></td>
            <td>IP address or hostname. Required if port is present.</td>
        </tr>
         <tr>
            <td>port</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>TCP/IP Port number.</td>
        </tr>
        <tr>
            <td>outboundProxyServerNetAddress</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Outbound proxy server IP address or hostname.</td>
        </tr>
        <tr>
            <td>stunServerNetAddress</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>STUN server IP address or hostname.</td>
        </tr>
        <tr>
            <td>macAddress</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>MAC Address. Must be a valid MAC address.</td>
        </tr>
        <tr>
            <td>serialNumber</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Serial number.</td>
        </tr>
        <tr>
            <td>description</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Description of device.</td>
        </tr>
        <tr>
            <td>physicalLocation</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Physical geographic location of the device, used in conjunction with the Physical Location user service.</td>
        </tr>
        <tr>
            <td>transportProtocol</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>Transport protocol. One of {'UDP'|'TCP'|'Unspecified'}.</td>
        </tr>
        <tr>
            <td>deviceCredentials</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                Container for access device credentials information.<br />
                Details of the device credentials properties:
                <table border=1>
                    <thead>
                    <th>Property</th>
                    <th>Required?</th>
                    <th>Default</th>
                    <th>Description</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>enabled</td>
                            <td style="text-align: center; font-weight:bold">yes</td>
                            <td>n/a</td>
                            <td>Enable access device credentials.</td>
                        </tr>
                        <tr>
                            <td>username</td>
                            <td style="text-align: center; font-weight:bold">yes</td>
                            <td>n/a</td>
                            <td>Access device userId.</td>
                        </tr>
                        <tr>
                            <td>username</td>
                            <td style="text-align: center; font-weight:bold">yes</td>
                            <td>n/a</td>
                            <td>Access device password. Will be validated against device access password complexity rules.</td>
                        </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>sacGroupName</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                <b>Not Implemented</b> - including this will result in a 501 Not Implemented response.<br />
                Loki Server ID of an existing Site-level Session Admission Control group to which the new device should be added.
            </td>
        </tr>
        <tr>
            <td>customTags</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                <b>Not Implemented</b> - including this will result in a 501 Not Implemented response.<br />
                A set of custom tags (with values) to be added to the new device.
            </td>
        </tr>
        <tr>
            <td>extensions</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                <b>Not Implemented</b> - including this will result in a 501 Not Implemented response.
                Container for network-element specific properties.
            </td>
        </tr>
        <tr>
            <td>extensions.broadworks</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                <b>Not Implemented</b> - including this will result in a 501 Not Implemented response.
                Container for BroadWorks-specific properties.
            </td>
        </tr>
        <tr>
            <td>extensions.broadworks.mobilityManager</td>
            <td style="text-align: center;">no</td>
            <td></td>
            <td>
                <b>Not Implemented</b> - including this will result in a 501 Not Implemented response.<br />
                Container for BroadWorks Mobility Manager propreties. Properties:
                <table border=1>
                    <thead>
                    <th>Property</th>
                    <th>Required?</th>
                    <th>Default</th>
                    <th>Description</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>provisioningURL</td>
                            <td style="text-align: center;">varies</td>
                            <td>n/a</td>
                            <td>Required if “type” corresponds to a BroadWorks device type where “Mobility Manager Device” is true..</td>
                        </tr>
                        <tr>
                            <td>provisioningUserName</td>
                            <td style="text-align: center;">varies</td>
                            <td>n/a</td>
                            <td>Required if “type” corresponds to a BroadWorks device type where “Mobility Manager Device” is true..</td>
                        </tr>
                        <tr>
                            <td>provisioningPassword</td>
                            <td style="text-align: center;">varies</td>
                            <td>n/a</td>
                            <td>Required if “type” corresponds to a BroadWorks device type where “Mobility Manager Device” is true.</td>
                        </tr>
                        <tr>
                            <td>defaultOriginatingServiceKey</td>
                            <td style="text-align: center;">varies</td>
                            <td>n/a</td>
                            <td>Not valid if “type” corresponds to a BroadWorks device type where “Mobility Manager Device” is true.</td>
                        </tr>
                        <tr>
                            <td>defaultTerminatingServiceKey</td>
                            <td style="text-align: center;">varies</td>
                            <td>n/a</td>
                            <td>Not valid if “type” corresponds to a BroadWorks device type where “Mobility Manager Device” is true.</td>
                        </tr>
                </table>
            </td>
        </tr>
    </tbody>
</table>

##Response Properties - 201 Created

Besides the properties listed in the table below, the response also contains the normal HAL _links and curies properties.
<table border=1>
    <thead>
    <th>Parameter</th>
    <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>customerId</td>
            <td>A Loki Server ID (server-generated) of the existing Customer.</td>
       </tr>
       <tr>
            <td>siteId</td>
            <td>A Loki Server ID (server-generated) of the existing Site.</td>
       </tr>
       <tr>
            <td>deviceId</td>
            <td>
                A Loki Server ID (server-generated) of the created Site Device. The format of this is subject to change. <br />
                It is not guaranteed to match what is given as input ("deviceName") and also it is not guaranteed to match the created BroadWorks Device Name.
                This can be resolved in a future release with GET /loki/customers/{+customerId}/sites/{+siteId}/devices{?extensions.broadworks.deviceName}.
            </td>
       </tr>
       <tr>
            <td>extensions.broadworks.serviceProviderId</td>
            <td>The BroadWorks Service Provider/ Enterprise.<td>
       </tr>
       <tr>
            <td>extensions.broadworks.groupId</td>
            <td>The BroadWorks Group.</td>
       </tr>
        <tr>
            <td>extensions.broadworks.deviceName</td>
            <td>The BroadWorks Device Name that was created.</td>
       </tr>
    </tbody>
</table>

POST /loki/customers/{+customerId}/sites/{+siteId}/devices/{?mode}
{
    "deviceName": "Example Com AD3001",
    "type": "Adtran TA908",
    "protocol": "SIP 2.0",
    "hostname": "10.0.0.5",
    "port": 8080,
    "outboundProxyServerNetAddress": "proxy1.example.com",
    "stunServerNetAddress": "192.168.100.100",
    "macAddress": "AABBCC112233",
    "serialNumber": "A101-263",
    "description": "Device for Trunk 3001",
    "physicalLocation": "202 Main Street Nowhere, FR",
    "transportProtocol": "TCP",
    "deviceCredentials": {
        "enabled": true,
        "username": "4165551212",
        "password": "4D0fj$&zJ"
    },
    "sacGroupName": "Primary",
    "customTags": {
        "logo": "http://images.example.com/logo.png",
        "ntpServer": "tick.example.com"
    },
    "extensions" : {
        "broadworks" : {
            "mobilityManager" : {
                "provisioningURL" : "http://provisioning.example.com",
                "provisioningUserName" : "ExampleCom_1234",
                "provisioningPassword" : "2394SfaE",
                "defaultOriginatingServiceKey" : 42,
                "defaultTerminatingServiceKey" : 767
            }
        }
    }
}
< 201
< Content-Type: application/hal+json
< Transaction-Id: 1380080943120
< Location: http://localhost:8340/loki/customers/ExampleCom/sites/ExampleCom/devices/ExampleCom%20Trunk%203001
{
    "_links": {
        "self": {
            "href": "http://localhost:8340/loki/customers/ExampleCom/sites/ExampleCom/devices/Example%20Com%20AD3001"
        }
    },
    "customerId": "ExampleCom",
    "siteId": "ExampleCom",
    "deviceId": "IP New Device",
    "extensions": {
        "broadworks": {
            "deviceName": "IP New Device",
            "serviceProviderId": "ExampleCom",
            "groupId": "ExampleCom"
        }
    },
    "curies": [
        {
            "name": "ls",
            "href": "http://localhost/loki/rels/{rel}",
            "templated": true
        }
    ]
}

--
CHANGELOG

#2.39

Changes for S1783 42012: Loki REST: Site Device creation and TN Assign to a Site (parent):

* Added POST /loki/customers/{+customerId}/sites/{+siteId}/assignPhoneNumber{?mode}
* Added POST /loki/customers/{+customerId}/sites/{+siteId}/devices{?mode}

#2.38

Note the change to version numbers compatible with other Loki products.

Changes for S2018 LWS-REST: Add support for Activate/Deactivate TN in BroadWorks:
* Add POST /sites/{+siteId}/phone-numbers/activate and POST /sites/{+siteId}/phone-numbers/deactivate

Updates for S1945 LWS-REST: Add User with Trunk Group "None" (POST /loki/users{?mode}):

* Add userType and accessDevice for
* Remove sharedDeviceName and trunkGroupName
* Clarify that services.Authentication.password will be validated against the configured rules
* Document examples of Business Line and Trunking user adds
* Update example to show just one userType (businessLine)

Updates for S1945 LWS-REST: Add User with Trunk Group "None" (POST /customers/{+customerId}/sites/{+siteId}/trunk-groups{?mode}):

* Clarify that services.Authentication.password will be validated against the configured rules
* Clarify requirements for pilotUser object

General

* Clarify that GET on /loki/sites returns only a single resource
* Update json-schemas for various requests

#1.8

Changes for S1896 LWS-REST: BroadWorks Trunk Group Add (excludes Genband support):

* Added GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}
* Added POST /loki/customers/{+customerId}/sites/{+siteId}/trunk-groups{?mode}

#1.7 / 1.7.1
Changes for S2052 LWS-REST: VoIP User Add validation enhancements:

* Update POST /loki/users to return 422 for invalid attempt to set empty extension
* Update POST /loki/users to add missing input validation for properties under services.*

Changes for S2051 LWS-REST: Further improvements to error handling consistency:

* Updated handling of unexpected errors to follow LWS-REST 500 error response format (errorCode, summary, detail)

Changes for S2094 LWS-REST: Not possible to assign CFA (and other services) using userAdd REST call

* Clarified that any BroadWorks service can be assigned alacarte, even if it doesn't support configuration
* Update examples to show assignment of any BroadWorks service on a user, even if LWS-REST doesn't support pre-configuring its settings

General:

* Correct documented default value (3) for services.'Call Forwarding No Answer'.numberOfRings and services.'Third-Party Voice Mail Support'.noAnswerNumberOfRings
* Improved error response for the case where an object contains an invalid property
* POST /loki/users: clarify that userId must include @domain; enhance the input validation for userId
* POST /loki/users: clarify that the BroadWorks group's default extension length is used when auto-filling the extension
* POST /loki/users: note that the "no-number" tnRoutine is not allowed for Charge Number.

#1.6
Changes for *Functional Description: VoIP Entity Service – Enhancements for BroadWorks Multi-Cluster Support*:

* removed support for POST /loki/voip-users; replaced with POST /loki/users
* customerId and siteId moved from URI template into request body
* extensions.broadworks added to request body, with serviceProviderId and groupId

General:

* Change checkmark/x to yes/no for clarity
* Document 404 response for GET queries on Sonus resources
* Corrected data type for /loki/routes transmissionMedium property
* Completed documentation for user service settings in POST /loki/users

#1.5
Changes for *Functional Description: Alternate API Navigation*:

* Update URIs (self links, Location headers) to reflect changed URI construction
* Update response bodies to add new properties required to expand URI Template variables
* Convert POST /loki/customers/{+customerId}/sites/{+siteId}/voip-users 201 response to hal+json

Changes for *Functional Description: Sonus Entity and Utility Services - Subscriber, Destination, and Route Modify Support*:

* Add PUT /loki/{subscribers,destinations,routes}.

Changes for *Functional Description: Sonus Entity and Utility Services - Route Query Enhancements*:

* Update GET /routes{?...} documentation, supported URL query parameters, and 200 OK response body.

Changes for *Functional Description: VoIP User Create - Configure Call Forwarding Not Reachable (BroadWorks)*:

* Update POST /loki/customers/{+customerId}/sites/{+siteId}/voip-users request body to add Call Forwarding Not Reachable service.

General:

* Improve comments.
* Correct errors in json-schema.
* Add 404 example for POST /loki/number-translations.
* Document URL parameters for POST /loki/subscribers.
* Correct the URI in the Location header in POST /loki/routes 201 Created response, and in embedded ls:routes in 409 Conflict response, and in the 200 OK response to GET /loki/routes{?...}.
* Further updates to POST /loki/customers/{+customerId}/sites/{+siteId}/voip-users: improve documentation, add timeZone and language; add "+" in URI template parameters to indicate reserved expansion.
* Correct documentation to mark ?mode as required on POST /loki/voip-users.
--


-- JSON Schema Validations --

POST /loki/number-translations
{ "request" :
    { "type": "object",
          "properties": {
            "sourceDn": { "type": "string", "maxLength" : 48 },
            "translatedDn": { "type": "string", "maxLength" : 48 }
          },
        "required" : ["sourceDn", "translatedDn"]
    },
  "response" :
    { }
}

PUT /loki/number-translations/{+id}
{ "request" :
    { "type": "object",
        "properties" : {
                "translatedDn" : {},
                "extensions" : {}
            },
            "additionalProperties" : false
    },
    "response" : { }
}

POST /loki/subscribers
{ "request" :
    { "type": "object",
          "properties": {
            "subscriberDn": { "type": "string", "maxLength" : 48 }
          },
        "required" : ["subscriberDn"]
    },
  "response" :
    { }
}

PUT /loki/subscribers/{+id}
{ "request" :
    { "type": "object",
          "properties": {
                "extensions" : {}
            },
        "additionalProperties" : false
    },
  "response" :
    { }
}

POST /loki/destinations
{ "request" :
    { "type": "object",
          "properties": {
            "destinationDn": { "type": "string", "maxLength" : 48 }
          },
        "required" : ["destinationDn"]
    },
  "response" :
    { }
}

POST /loki/routes
{ "request" :
    { "type": "object",
          "properties": {
            "destinationDn": { "type": "string", "maxLength" : 48 }
          },
        "required" : ["destinationDn"]
    },
  "response" :
    { }
}

GET /loki/sites{?extensions.broadworks.serviceProviderId,extensions.broadworks.groupId}
{
	"request": {
		"get": {
			"query": {
				"id": "extensionsBroadworks",
				"type": "object",
				"additionalProperties": false,
				"title": "Get schema, query params",
				"description": "Validates extensions.broadworks query parameters",
				"properties": {
					"extensions.broadworks.serviceProviderId": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30,
						"required": true
					},
					"extensions.broadworks.groupId": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30,
						"required": true
					}
				}
			}
		}
	},
	"response": {}
}

POST /loki/users{?mode}
{
	"request": {
		"post": {
			"body": {
				"id": "voipUsersBody",
				"type": "object",
				"additionalProperties": false,
				"title": "Post schema, body",
				"properties": {
					"customerId": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30
					},
					"siteId": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30
					},
					"userId": {
						"$ref": "/userId"
					},
					"phoneNumber": {
						"$ref": "/bwksDnSchema"
					},
					"tnRoutine": {
						"$ref": "/tnRoutineWithNoNumber"
					},
					"extension": {
						"type": [
							"string",
							"null"
						],
						"minLength": 2,
						"maxLength": 20,
						"pattern": "^[0-9]+$"
					},
					"CLID": {
						"$ref": "/bwksDnSchema"
					},
					"lastName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30
					},
					"firstName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30
					},
					"callingLineIdLastName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30,
						"pattern": "^[\\x20-\\x21\\x23-\\x24\\x26-\\x2A\\x2C-\\x2E\\x30-\\x7F]+$"
					},
					"callingLineIdFirstName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30,
						"pattern": "^[\\x20-\\x21\\x23-\\x24\\x26-\\x2A\\x2C-\\x2E\\x30-\\x7F]+$"
					},
					"email": {
						"type": "string",
						"minLength": 1,
						"maxLength": 80,
						"format": "email"
					},
					"timeZone": {
						"type": "string",
						"minLength": 1,
						"maxLength": 127
					},
					"language": {
						"type": "string",
						"minLength": 1,
						"maxLength": 40
					},
					"role": {
						"type": "any"
					},
					"userType": {
						"enum": [
							"trunking",
							"businessLine",
							"centrex",
							"systemDevice",
							"noDevice"
						],
						"required": true
					},
					"accessDevice": {
						"type": "object",
						"additionalProperties": false,
						"description": "Details of the user's device, for Business Line, IP Centrex, and System Device users.",
						"properties": {
							"name": {
								"type": "string",
								"minLength": 1,
								"maxLength": 40,
								"required": true
							},
							"type": {
								"type": "any"
							},
							"model": {
								"type": "any"
							},
							"macAddress": {
								"type": "any"
							},
							"linePort": {
								"type": "any"
							}
						}
					},
					"trunkGroup": {
						"type": "object",
						"additionalProperties": false,
						"description": "Details of the user's trunk group(s), for Trunking users.",
						"properties": {
							"name": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30
							},
							"linePort": {
								"type": "any"
							}
						}
					},
					"servicePacks": {
						"type": "object",
						"additionalProperties": false,
						"description": "Service Packs that will be assigned to User",
						"properties": {
							"base": {
								"type": "string",
								"minLength": 1,
								"maxLength": 80
							},
							"add-on": {
								"type": "array",
								"items": {
									"type": "string",
									"minLength": 1,
									"maxLength": 80
								}
							}
						}
					},
					"services": {
						"type": "object",
						"properties": {
							"Authentication": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"username": {
										"type": "string",
										"minLength": 1,
										"maxLength": 80
									},
									"password": {
										"type": "string",
										"minLength": 1,
										"maxLength": 60
									}
								}
							},
							"Charge Number": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"phoneNumber": {
										"extends": [
											{
												"$ref": "/bwksDnSchema"
											},
											{
												"type": [
													"string",
													"null"
												]
											}
										]
									},
									"useChargeNumberForEnhancedTranslations": {
										"type": "boolean"
									},
									"sendChargeNumberToNetwork": {
										"type": "boolean"
									},
									"tnRoutine": {
										"$ref": "/tnRoutine"
									}
								}
							},
							"Third-Party Voice Mail Support": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"isActive": {
										"type": "boolean"
									},
									"busyRedirectToVoiceMail": {
										"type": "boolean"
									},
									"noAnswerRedirectToVoiceMail": {
										"type": "boolean"
									},
									"noAnswerNumberOfRings": {
										"$ref": "/numberOfRings"
									},
									"alwaysRedirectToVoiceMail": {
										"type": "boolean"
									},
									"outOfPrimaryZoneRedirectToVoiceMail": {
										"type": "boolean"
									},
									"serverSelection": {
										"enum": [
											"Group Mail Server",
											"User Specific Mail Server"
										]
									},
									"userServer": {
										"$ref": "/outgoingDnOrSipUri"
									},
									"mailboxIdType": {
										"enum": [
											"User Or Group Phone Number",
											"URL"
										]
									},
									"mailboxURL": {
										"extends": [
											{
												"$ref": "/bwksSipUri"
											},
											{
												"type": [
													"string",
													"null"
												]
											}
										]
									}
								}
							},
							"Call Forwarding No Answer": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"isActive": {
										"type": "boolean"
									},
									"forwardToPhoneNumber": {
										"$ref": "/outgoingDnOrSipUri"
									},
									"numberOfRings": {
										"$ref": "/numberOfRings"
									}
								}
							},
							"Call Forwarding Not Reachable": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"isActive": {
										"type": "boolean",
										"required": false
									},
									"forwardToPhoneNumber": {
										"$ref": "/outgoingDnOrSipUri"
									}
								}
							}
						}
					},
					"extensions": {
						"type": "object",
						"additionalProperties": false,
						"properties": {
							"broadworks": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"serviceProviderId": {
										"type": "string",
										"minLength": 1,
										"maxLength": 30
									},
									"groupId": {
										"type": "string",
										"minLength": 1,
										"maxLength": 30
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"definitions": {
		"voipUsersURISchema": {
			"post": {
				"params": {
					"id": "voipUsersURL",
					"type": "object",
					"additionalProperties": false,
					"title": "Get schema, params",
					"description": "Validates mode parameter",
					"properties": {
						"mode": {
							"enum": [
								"create-only"
							]
						}
					}
				}
			}
		},
		"userId": {
			"type": "string",
			"minLength": 1,
			"maxLength": 161,
			"pattern": "^[\\w'#\\$\\%&\\-\\/=\\?;\\.\\|~\\!`\\^\\{\\}][\\w'#\\$\\%&\\-\\/=\\?;\\.\\|~\\!`\\^\\{\\}\\+]{5,79}@[a-zA-Z\\d\\.\\-]{2,80}$"
		},
		"tnRoutineWithNoNumber": {
			"enum": [
				null,
				"",
				"port-no-temp",
				"auto",
				"no-number"
			]
		},
		"bwksDnSchema": {
			"type": "string",
			"description": "A formatted TN.",
			"pattern": "^\\+\\d+-\\d+$",
			"minLength": 1,
			"maxLength": 23,
			"required": false
		},
		"tnRoutine": {
			"enum": [
				null,
				"",
				"port-no-temp",
				"auto"
			]
		},
		"numberOfRings": {
			"enum": [
				0,
				2,
				3,
				4,
				5,
				6,
				7,
				8,
				9,
				10,
				11,
				12,
				13,
				14,
				15,
				16,
				17,
				18,
				19,
				20
			]
		},
		"bwksNonFormattedDnSchema": {
			"type": "string",
			"description": "A non-E.164 formatted TN.",
			"pattern": "^[\\d\\-]+$",
			"minLength": 1,
			"maxLength": 23,
			"required": false
		},
		"outgoingDnOrSipUri": {
			"anyOf": [
				{
					"id": "E.164 DN",
					"extends": [
						{
							"$ref": "/bwksDnSchema"
						},
						{
							"type": [
								"string",
								"null"
							]
						}
					]
				},
				{
					"id": "non-E.164 DN",
					"$ref": "/bwksNonFormattedDnSchema"
				},
				{
					"id": "SIP URI",
					"$ref": "/bwksSipUri"
				}
			]
		},
		"bwksSipUri": {
			"type": "string",
			"description": "SIP URI",
			"pattern": "^[\\+]?[\\w\\-\\.\\!~\\*'\\(\\)]+@[a-zA-Z\\d\\.\\-]+$",
			"minLength": 1,
			"maxLength": 161,
			"required": false
		}
	},
	"response": {}
}

PUT /loki/users/{+userId}/call-processing-policy
{
    "request" : {
        "type": "object",
        "properties" : {
                "extensions" : {
                    "type": "object",
                    "properties" : {
                        "broadworks" : {}
                    }
                }
            }
        },
    "response" : { }
}

POST /loki/customers/{+customerId}/sites/{+siteId}/trunk-groups{?mode}
{
	"request": {
		"post": {
			"body": {
				"id": "voipTrunkGroupsBody",
				"type": "object",
				"required": true,
				"additionalProperties": false,
				"title": "Post schema, body",
				"properties": {
					"trunkGroupName": {
						"type": "string",
						"minLength": 1,
						"maxLength": 30,
						"required": true
					},
					"accessDevice": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"deviceManagementRoutine": {
								"enum": [
									"create",
									"existing"
								]
							},
							"level": {
								"enum": [
									"Site"
								],
								"required": true
							},
							"deviceType": {
								"type": "string",
								"minLength": 1,
								"maxLength": 40
							},
							"deviceName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 40,
								"required": true
							},
							"hostname": {
								"type": "string",
								"minLength": 1,
								"maxLength": 80
							}
						}
					},
					"pilotUser": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"customerId": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30
							},
							"siteId": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30
							},
							"userId": {
								"$ref": "/userId"
							},
							"phoneNumber": {
								"$ref": "/bwksDnSchema"
							},
							"tnRoutine": {
								"$ref": "/tnRoutineWithNoNumber"
							},
							"extension": {
								"type": [
									"string",
									"null"
								],
								"minLength": 2,
								"maxLength": 20,
								"pattern": "^[0-9]+$"
							},
							"CLID": {
								"$ref": "/bwksDnSchema"
							},
							"lastName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30
							},
							"firstName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30
							},
							"callingLineIdLastName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30,
								"pattern": "^[\\x20-\\x21\\x23-\\x24\\x26-\\x2A\\x2C-\\x2E\\x30-\\x7F]+$"
							},
							"callingLineIdFirstName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 30,
								"pattern": "^[\\x20-\\x21\\x23-\\x24\\x26-\\x2A\\x2C-\\x2E\\x30-\\x7F]+$"
							},
							"email": {
								"type": "string",
								"minLength": 1,
								"maxLength": 80,
								"format": "email"
							},
							"timeZone": {
								"type": "string",
								"minLength": 1,
								"maxLength": 127
							},
							"language": {
								"type": "string",
								"minLength": 1,
								"maxLength": 40
							},
							"role": {
								"type": "any"
							},
							"servicePacks": {
								"type": "object",
								"additionalProperties": false,
								"description": "Service Packs that will be assigned to User",
								"properties": {
									"base": {
										"type": "string",
										"minLength": 1,
										"maxLength": 80
									},
									"add-on": {
										"type": "array",
										"items": {
											"type": "string",
											"minLength": 1,
											"maxLength": 80
										}
									}
								}
							},
							"services": {
								"type": "object",
								"properties": {
									"Authentication": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"username": {
												"type": "string",
												"minLength": 1,
												"maxLength": 80
											},
											"password": {
												"type": "string",
												"minLength": 1,
												"maxLength": 60
											}
										}
									},
									"Charge Number": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"phoneNumber": {
												"extends": [
													{
														"$ref": "/bwksDnSchema"
													},
													{
														"type": [
															"string",
															"null"
														]
													}
												]
											},
											"useChargeNumberForEnhancedTranslations": {
												"type": "boolean"
											},
											"sendChargeNumberToNetwork": {
												"type": "boolean"
											},
											"tnRoutine": {
												"$ref": "/tnRoutine"
											}
										}
									},
									"Third-Party Voice Mail Support": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"isActive": {
												"type": "boolean"
											},
											"busyRedirectToVoiceMail": {
												"type": "boolean"
											},
											"noAnswerRedirectToVoiceMail": {
												"type": "boolean"
											},
											"noAnswerNumberOfRings": {
												"$ref": "/numberOfRings"
											},
											"alwaysRedirectToVoiceMail": {
												"type": "boolean"
											},
											"outOfPrimaryZoneRedirectToVoiceMail": {
												"type": "boolean"
											},
											"serverSelection": {
												"enum": [
													"Group Mail Server",
													"User Specific Mail Server"
												]
											},
											"userServer": {
												"$ref": "/outgoingDnOrSipUri"
											},
											"mailboxIdType": {
												"enum": [
													"User Or Group Phone Number",
													"URL"
												]
											},
											"mailboxURL": {
												"extends": [
													{
														"$ref": "/bwksSipUri"
													},
													{
														"type": [
															"string",
															"null"
														]
													}
												]
											}
										}
									},
									"Call Forwarding No Answer": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"isActive": {
												"type": "boolean"
											},
											"forwardToPhoneNumber": {
												"$ref": "/outgoingDnOrSipUri"
											},
											"numberOfRings": {
												"$ref": "/numberOfRings"
											}
										}
									},
									"Call Forwarding Not Reachable": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"isActive": {
												"type": "boolean",
												"required": false
											},
											"forwardToPhoneNumber": {
												"$ref": "/outgoingDnOrSipUri"
											}
										}
									}
								}
							},
							"extensions": {
								"type": "object",
								"additionalProperties": false,
								"properties": {
									"broadworks": {
										"type": "object",
										"additionalProperties": false,
										"properties": {
											"serviceProviderId": {
												"type": "string",
												"minLength": 1,
												"maxLength": 30
											},
											"groupId": {
												"type": "string",
												"minLength": 1,
												"maxLength": 30
											}
										}
									}
								}
							}
						}
					},
					"department": {
						"type": "string",
						"minLength": 1,
						"maxLength": 50
					},
					"capacityManagement": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"maxActiveCalls": {
								"type": "object",
								"required": true,
								"additionalProperties": false,
								"properties": {
									"total": {
										"type": "integer",
										"minimum": 1,
										"required": true
									},
									"incoming": {
										"type": "integer",
										"minimum": 1,
										"maximum": 999999
									},
									"outgoing": {
										"type": "integer",
										"minimum": 1,
										"maximum": 999999
									}
								}
							},
							"burstingMaxActiveCalls": {
								"type": "object",
								"required": true,
								"additionalProperties": false,
								"properties": {
									"enabled": {
										"$ref": "/requiredBoolean"
									},
									"total": {
										"type": "integer",
										"minimum": 0,
										"maximum": 999999
									},
									"incoming": {
										"type": "integer",
										"minimum": 0,
										"maximum": 999999
									},
									"outgoing": {
										"type": "integer",
										"minimum": 0,
										"maximum": 999999
									}
								}
							},
							"incomingCapacityExceeded": {
								"type": "object",
								"required": true,
								"additionalProperties": false,
								"properties": {
									"action": {
										"$ref": "/trunkingActions"
									},
									"forwardAddress": {
										"$ref": "/outgoingDnOrSipUri"
									},
									"rerouteTrunkGroup": {
										"$ref": "/rerouteTrunkGroup"
									},
									"initialCalls": {
										"type": "integer",
										"minimum": 0,
										"required": true
									},
									"offsetCalls": {
										"type": "integer",
										"minimum": 0,
										"required": true
									}
								}
							}
						}
					},
					"unreachableDestination": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"timeout": {
								"type": "integer",
								"minimum": 0,
								"maximum": 15,
								"required": true
							},
							"action": {
								"$ref": "/trunkingActions"
							},
							"forwardAddress": {
								"$ref": "/outgoingDnOrSipUri"
							},
							"rerouteTrunkGroup": {
								"$ref": "/rerouteTrunkGroup"
							}
						}
					},
					"authentication": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"enabled": {
								"$ref": "/requiredBoolean"
							},
							"username": {
								"type": "string",
								"minLength": 1,
								"maxLength": 80
							},
							"password": {
								"type": "string",
								"minLength": 1,
								"maxLength": 60
							}
						}
					},
					"hostedUsers": {
						"type": "array"
					},
					"identity": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"trunkGroupIdentity": {
								"type": "object",
								"required": true,
								"additionalProperties": false,
								"properties": {
									"identity": {
										"$ref": "/bwksSipUri"
									},
									"allowTerminationToTrunkGroupIdentity": {
										"$ref": "/requiredBoolean"
									},
									"includeTrunkGroupIdentity": {
										"$ref": "/requiredBoolean"
									},
									"includeTrunkGroupIdentityForNetworkCalls": {
										"$ref": "/requiredBoolean"
									}
								}
							},
							"otgDtgIdentity": {
								"type": "object",
								"required": true,
								"additionalProperties": false,
								"properties": {
									"identity": {
										"type": "string",
										"minLength": 1,
										"maxLength": 80
									},
									"allowTerminationToDtgIdentity": {
										"$ref": "/requiredBoolean"
									},
									"includeDtgIdentity": {
										"$ref": "/requiredBoolean"
									},
									"includeOtgIdentityForNetworkCalls": {
										"$ref": "/requiredBoolean"
									}
								}
							},
							"enableNetworkAddressIdentity": {
								"$ref": "/requiredBoolean"
							}
						}
					},
					"allowUnscreenedCalls": {
						"$ref": "/requiredBoolean"
					},
					"allowUnscreenedEmergencyCalls": {
						"$ref": "/requiredBoolean"
					},
					"pilotUserCallingLineIdentityPolicy": {
						"enum": [
							"All Originating Calls",
							"Unscreened Originating Calls",
							"No Calls"
						],
						"required": true
					},
					"pilotUserChargeNumberPolicy": {
						"enum": [
							"All Originating Calls",
							"Unscreened Originating Calls",
							"No Calls"
						],
						"required": true
					},
					"callForwardingAlways": {
						"type": "object",
						"additionalProperties": false,
						"properties": {
							"action": {
								"$ref": "/trunkingActions"
							},
							"forwardAddress": {
								"$ref": "/outgoingDnOrSipUri"
							},
							"rerouteTrunkGroup": {
								"$ref": "/rerouteTrunkGroup"
							}
						}
					},
					"peeringDomain": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"domainName": {
								"type": "string",
								"minLength": 1,
								"maxLength": 80
							},
							"routeToPeeringDomain": {
								"$ref": "/requiredBoolean"
							}
						}
					},
					"trunkGroupPrefix": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"enabled": {
								"$ref": "/requiredBoolean"
							},
							"prefix": {
								"type": "string",
								"minLength": 1,
								"maxLength": 15
							}
						}
					},
					"advancedReroute": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"enabled": {
								"$ref": "/requiredBoolean"
							},
							"sendContinuousOptionsMessage": {
								"$ref": "/requiredBoolean"
							},
							"continuousOptionsSendingInterval": {
								"type": "integer",
								"minimum": 30,
								"maximum": 86400,
								"required": true
							},
							"failureOptionsSendingInterval": {
								"type": "integer",
								"minimum": 10,
								"maximum": 86400,
								"required": true
							},
							"failureThresholdCounter": {
								"type": "integer",
								"minimum": 1,
								"maximum": 60,
								"required": true
							},
							"successThresholdCounter": {
								"type": "integer",
								"minimum": 1,
								"maximum": 60,
								"required": true
							},
							"inviteFailureThresholdCounter": {
								"type": "integer",
								"minimum": 1,
								"maximum": 60,
								"required": true
							},
							"inviteFailureThresholdWindow": {
								"type": "integer",
								"minimum": 30,
								"maximum": 240,
								"required": true
							}
						}
					},
					"pilotUserCallingLineAssertedIdentityPolicy": {
						"type": "object",
						"required": true,
						"additionalProperties": false,
						"properties": {
							"useTrunkGroupCallingLineAssertedIdentityPolicy": {
								"$ref": "/requiredBoolean"
							},
							"callingLineAssertedIdentityPolicy": {
								"enum": [
									"All Originating Calls",
									"Unscreened Originating Calls"
								],
								"required": true
							}
						}
					}
				}
			}
		}
	},
	"definitions": {
		"requiredBoolean": {
			"type": "boolean",
			"required": true
		},
		"trunkingActions": {
			"enum": [
				"Forward",
				"Reroute"
			]
		},
		"bwksNonFormattedDnSchema": {
			"type": "string",
			"description": "A non-E.164 formatted TN.",
			"pattern": "^[\\d\\-]+$",
			"minLength": 1,
			"maxLength": 23,
			"required": false
		},
		"outgoingDnOrSipUri": {
			"anyOf": [
				{
					"id": "E.164 DN",
					"extends": [
						{
							"$ref": "/bwksDnSchema"
						},
						{
							"type": [
								"string",
								"null"
							]
						}
					]
				},
				{
					"id": "non-E.164 DN",
					"$ref": "/bwksNonFormattedDnSchema"
				},
				{
					"id": "SIP URI",
					"$ref": "/bwksSipUri"
				}
			]
		},
		"rerouteTrunkGroup": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"siteId": {
					"type": "string",
					"minLength": 1,
					"maxLength": 30
				},
				"trunkGroupName": {
					"type": "string",
					"minLength": 1,
					"maxLength": 30
				}
			}
		},
		"bwksSipUri": {
			"type": "string",
			"description": "SIP URI",
			"pattern": "^[\\+]?[\\w\\-\\.\\!~\\*'\\(\\)]+@[a-zA-Z\\d\\.\\-]+$",
			"minLength": 1,
			"maxLength": 161,
			"required": false
		}
	},
	"response": {}
}

POST /loki/sites/{+siteId}/phone-numbers/activate
{
	"request": {
		"post": {
			"body": {
				"id": "voipTNActivationBody",
				"type": "object",
				"required": true,
				"additionalProperties": false,
				"title": "Post schema, body",
				"properties": {
					"phoneNumbers": {
						"type": "array",
						"items": {
							"anyOf": [
								{
									"id": "E.164 DN",
									"$ref": "/bwksDnSchema"
								},
								{
									"id": "TN Range",
									"type": "object",
									"additionalProperties": false,
									"properties": {
										"start": {
											"$ref": "/bwksDnSchema"
										},
										"end": {
											"$ref": "/bwksDnSchema"
										}
									}
								}
							]
						}
					}
				}
			}
		}
	},
	"definitions": {
		"bwksDnSchema": {
			"type": "string",
			"description": "A formatted TN.",
			"pattern": "^\\+\\d+-\\d+$",
			"minLength": 1,
			"maxLength": 23,
			"required": false
		}
	},
	"response": {}
}

POST /loki/sites/{+siteId}/phone-numbers/deactivate
{
	"request": {
		"post": {
			"body": {
				"id": "voipTNActivationBody",
				"type": "object",
				"required": true,
				"additionalProperties": false,
				"title": "Post schema, body",
				"properties": {
					"phoneNumbers": {
						"type": "array",
						"items": {
							"anyOf": [
								{
									"id": "E.164 DN",
									"$ref": "/bwksDnSchema"
								},
								{
									"id": "TN Range",
									"type": "object",
									"additionalProperties": false,
									"properties": {
										"start": {
											"$ref": "/bwksDnSchema"
										},
										"end": {
											"$ref": "/bwksDnSchema"
										}
									}
								}
							]
						}
					}
				}
			}
		}
	},
	"definitions": {
		"bwksDnSchema": {
			"type": "string",
			"description": "A formatted TN.",
			"pattern": "^\\+\\d+-\\d+$",
			"minLength": 1,
			"maxLength": 23,
			"required": false
		}
	},
	"response": {}
}